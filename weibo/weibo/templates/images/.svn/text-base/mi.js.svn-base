MI.TalkListRich=1;(function(){var l=UI.G,d=UI.GC;if(!window.MIApp||window.MIApp.lib)window.$=UI.G,window.$$=UI.GC;MI.tmpl.videoTool='<div class="vTools bor_bg" style="display:block"><a href="#" class="vClose"><em></em>'+_("收起")+'</a><a href="$VideoRealUrl" class="vUrl" target="_blank"><em></em>$VideoTitle</a></div>';MI.tmpl.videoThumbs='<a href="#" class="vThumbs" url="$VideoPlayUrl"><span class="mask"><em></em></span><img src="$VideoPicUrl" /></a>';MI.tmpl.videoObject='<object name="$VideoPlayID" id="$VideoPlayID" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="460" height="372" ><param name="wmode" value="transparent" /><param name="movie" value="$VideoPlayUrl" /><param name="allowFullScreen" value="true" /><param name="flashvars" value="playMovie=true&amp;isAutoPlay=true&amp;auto=1&amp;autoPlay=true&amp;adss=0$outhost"><param name="swfversion" value="50536.0.0.0" /><param name="expressinstall" value="Scripts/expressInstall.swf" /></object>';MI.tmpl.videoEmbed='<embed name="$VideoPlayID" id="$VideoPlayID" src="$VideoPlayUrl" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="460" height="372" allowFullScreen="true" flashvars="playMovie=true&amp;isAutoPlay=true&amp;auto=1&amp;autoPlay=true&amp;adss=0$outhost" wmode="transparent"></embed>';MI.tmpl.videoHTML5='<video width="460" height="362" controls="1" autoplay="autoplay" autobuffer="true" src="$VideoPlayUrl"></video>';MI.TalkList.prototype.creatConfirm=function(){var b=this;if(!b._confirm){b._confirm=UI.html('<div class="delChose"><span></span><br><label class="gb_btn gb_btn1"><input type="button" value="'+_("确定")+'" class="t"></label> <label class="gb_btn gb_btn5"><input type="button" value="'+_("取消")+'" class="t"></label></div>')[0];b._confirmTip=d(b._confirm,"span")[0];var a=d(b._confirm,"input");a[0].onclick=function(){try{var a=0;if(MI.TalkList.lastMusic)try{b._confirm.tid==b._confirm.parentNode.parentNode.id&&(a=1)}catch(e){}a&&(MI.TalkList.musicClose(),MI.user.fun.newMusic&&(window.MUSIC&&MUSIC.ICMusic)&&MUSIC.ICMusic.hideFlash(MI.TalkList.lastMusic))}catch(f){}b.remove(b._confirm.tid,b._confirm.type)};a[1].onclick=function(){var a=b._confirm.parentNode.parentNode,e=UI.next(a);UI.removeClass(a,"hover");UI.remove(b._confirm);e&&MI.focus(d(e,".userName a")[0])};a[1]=a[0]=null}};MI.TalkList.prototype.createCollect=function(b){var a=this;MI.app({TalkBoxRich:function(){MI.TalkBox.prototype.microTpc.call(a,b)}})};MI.TalkList.prototype.focus=function(){if(!UI.B.ipad){var b=d(l(this.cur),".relay")[0];b&&(UI.B.ie&&(b.onfocusout=function(){"BODY"==document.activeElement.nodeName&&setTimeout(function(){b.focus()},200)}),setTimeout(function(){b.focus()},0))}};MI.TalkList.prototype.creatBox=function(b){var a=this,c=b?UI.A(b,"id"):"",e=b?UI.A(b,"vmode"):"",f=b?UI.A(b,"data-zone")||0:0,g=b&&"2"==UI.A(b,"tv")?UI.A(b,"tvs"):"",b="relayListBox_"+c;if(1==a.type||2==a.type||4==a.type)MI.tmpl.reply=MI.tmpl.reply.replace(/<div class="sendList uploadPic".*?<\/div>/ig,"");a.talkBoxTmpl=MI.tmpl.reply;a._talk=UI.html(a.talkBoxTmpl)[0];var c=MI.user.fun.syncQzone?"checked":"",h=1==a.type||2==a.type||4==a.type?"none":"";a._relay=UI.html(a.talkBoxTmpl.replace('<div class="left"></div>','<div class="left" style="display:"><label style="display:'+h+';"><input type="checkbox" '+c+' class="replayQzoneCheckbox check1">'+_("转播到空间")+"</label></div>"))[0];a._comt=UI.html(a.talkBoxTmpl.replace('<div class="left"></div>','<div class="left"><label style="display:"><input id="replayListCheckbox" type="checkbox" class="check1">'+_("同时转播")+'</label> <label style="display:'+h+';"><input type="checkbox"  '+c+' class="replayQzoneCheckbox check1">'+_("评论到空间")+"</label></div>"))[0];var i=[],c=[];if(!a.insTalkbox||a.relayListMulti){h=1;if(1==a.type||2==a.type||4==a.type)h=0;e=a.talkBoxTmpl.replace("talkWrap",2==a.type||4==a.type||2==f||e?"zfWrap comtWrap":"zfWrap").replace('<div class="left"></div>','<div class="left" style="display:;"><label style="display:'+(1==a.type||1==f?"":"none")+';"><input id="replayListCheckbox" type="checkbox"'+(h?" checked":"")+' class="check1">'+_("同时转播")+'</label> <label style="display:'+(1==a.type||2==a.type||4==a.type?"none":"")+';"><input type="checkbox" '+(MI.user.fun.syncQzone?" checked":"")+' class="replayQzoneCheckbox check1"><span>'+(h?_("转播"):_("评论"))+"</span>"+_("到空间")+"</label></div>").replace("talkSuc","");a.insTalkbox||(relayListBox=UI.html(e)[0],i=[new MI.TalkBox(a._talk),new MI.TalkBox(a._relay),new MI.TalkBox(a._comt),new MI.TalkBox(relayListBox)],c=["replyBox","relayBox","comtBox","relayListBox"]);a.relayListMulti&&!a[b]&&(relayListBox=UI.html(e)[0],a[b]={},i.push(new MI.TalkBox(relayListBox)),c.push(b));c.length&&UI.each(c,function(b,c){for(var f in a[b])i[c][f]=a[b][f];i[c].addListTmp=i[c].addList;a[b]=i[c];a[b]._txt.id=a[b]._txt.name=b+"_"+MI.random()});if(!a.insTalkbox){a.replyBox.guideTextKeep=0;a.replyBox.autoHeight=30;a.relayBox.autoHeight=136;a.comtBox.autoHeight=136;a.replyBox.txtTipSend=_("发送中");a.relayBox.txtTipSend=_("转播中");a.comtBox.txtTipSend=_("评论中");a.replyBox._btn.title=_("发送");a.relayBox._btn.title=_("转播");a.comtBox._btn.title=_("评论");if(1==a.type||2==a.type||4==a.type)a.comtBox._btn.title=_("评论");a.replyBox.hideCall=a.relayBox.hideCall=a.comtBox.hideCall=function(){UI.removeClass(l(a.cur),"cur");a.showComtReply(l(a.cur))};UI.remove(d(a.replyBox._body,".uploadPic")[0]);a.replyBox.start=a.relayBox.start=a.comtBox.start=function(){a.checkTalkId();a.talkBox._txt.blur();a.focus()};a.replyBox.success=a.relayBox.success=a.comtBox.success=function(b,c){if(c)UI.hide(a.talkBox._relayList);else{a.talkBox.hide();a.talkBox.display=0;UI.removeClass(l(a.cur),"hover")}if(a._relayNum){UI.each(a._relayNum,function(b,c){a.talkBox.type!=1&&c||MI.countNum(b,1)});a._relayNum=null}a.relayCall&&a.talkBox.type==1?a.relayCall(b):a.replyCall&&a.talkBox.type==2?a.replyCall(b):a.commentCall&&(a.talkBox.type==4||a.talkBox.type==5)&&a.commentCall(b);if((a.talkBox.type==1||a.talkBox.type==5)&&g!=""){var f=a.talkBox.type==1?"2":a.talkBox.type==5?"3":"";f&&MI.AdStat(g+","+f)}};a.relayBox._numSon=d(a.relayBox._body,".number")[0];a.relayBox._relayCheck=d(a.relayBox._body,".check1")[0]||UI.DC("b");a.relayBox._relayList&&UI.remove(a.relayBox._relayList);a.relayBox._relayList=UI.html('<div class="relayList bgr3" style="display:none"></div>')[0];UI.append(a.relayBox._relayList,a.relayBox._body);a.comtBox._relayList&&UI.remove(a.comtBox._relayList);a.comtBox._relayList=UI.html('<div class="relayList bgr3" style="display:none"></div>')[0];UI.append(a.comtBox._relayList,a.comtBox._body);a.comtBox._numSon=d(a.comtBox._body,".number")[0];a.comtBox._relayCheck=d(a.comtBox._body,".check1")[0]||UI.DC("b");a.comtBox._relayCheckLabel=a.comtBox._relayCheck.parentNode;a.comtBox.addListCheck=0;a.comtBox._relayCheck.onclick=function(){var b=this.checked;a.comtBox.type=b?1:5;a.comtBox._tip.innerHTML="";a.comtBox.countTxt();if(!a.comtBox.addList||a.comtBox.addListCheck){a.comtBox.addList=b?a.relayBox.addList:0;a.comtBox.addListCheck=1}MI.Bos("btnRelayistCheckbox")};UI.B.ipad&&UI.EA(a.relayBox._txt,"focus",function(){setTimeout(function(){MI.selectTxt(a.relayBox._txt,0,0,0)},100)});UI.EA(a.replyBox._close,"click",function(){a.collapseInit()});UI.EA(a.relayBox._close,"click",function(){a.collapseInit()});UI.EA(a.comtBox._close,"click",function(){a.collapseInit()});a.insTalkbox=1;a.relayListMulti||(a.creatBox=function(){a.relayBox._relayCheck.checked=MI.user.fun.syncQzone?true:false})}}};MI.TalkList.reportReaded={};MI.TalkList.prototype.reportRead=function(b){MI.user.fun.reportRead&&!MI.TalkList.reportReaded[b.id]&&(MI.ajax({url:MI.url.reportRead,type:"get",data:b}),MI.TalkList.reportReaded[b.id]=1)};MI.TalkList.prototype.report=function(b,a,c,e){var f=this,c=c?c:0,e=e?e:{qid:"",zone:""};if(a.innerHTML!=_("举报")){var e=d(l(b),".userName a")[0]||d(l(b),".msgCnt strong a")[0],g=a="",a="";e&&(a=UI.A(e,"rel"),g=MI.string.account(a),a=a.replace(/\([^(]+$/g,""));MI.confirm({type:"error",title:_("确定删除这条广播？"),width:250,content:'<label for="blankHe" class="nullFmt checkbox_item"><input type="checkbox" id="blankHe" align="middle" value="0"><span class="info">'+_(" 同时将<span> {0} </span>加入黑名单",MI.string.cut(a,16,"..."))+"</span></label>",confirm:function(){MI.ajax({url:MI.url.reportSpam,data:{id:MI.string.parseInt(b),type:c||1},success:function(a){a=MI.json(a);if(a.result==0){(a=l("blankHe"))&&a.checked&&MI.ajax({url:MI.url.block,data:{u:g}});var c=l(b);UI.hasClass(c,"orginCnt")?MI.goHome():UI.animate(c,"opacity",0,function(){UI.remove(c);f.bottom()})}else a.msg&&MI.alert(a.msg)}});MI.dialog.hide()},cancel:function(){MI.dialog.hide()}});MI.Bos("btnReportFast")}else a=UI.A(d(l(b),".userName")[0]||d(l(b),".msgCnt strong a")[0],"rel"),1==c?(a=e.zone?e.zone:1,e=e.qid?e.qid:"",jubao_qun_msg(MI.string.parseInt(b),e,a)):(MI.Bos("btnReportMessage"),jubao_msg(MI.string.parseInt(b),a))};MI.TalkList.prototype.reportQun=function(b,a,c){c=c?c:1;UI.A(d(l(b),".userName")[0]||d(l(b),".msgCnt strong a")[0],"rel");jubao_qun_msg(MI.string.parseInt(b),a,c)};MI.TalkList.prototype.getComtReply=function(b){return d(b,".comtOrg")[0]};MI.TalkList.prototype.showComtReply=function(b){MI.user.fun.comtReply&&UI.show(this.getComtReply(b))};MI.TalkList.prototype.hideComtReply=function(b){MI.user.fun.comtReply&&UI.hide(this.getComtReply(b))};MI.TalkList.prototype.addOneAnimate=function(b){var a=this;a.addOnePop=a.addOnePop||UI.html('<b style="color:#f00;width:30px;position:absolute;left:-10px;text-decoration:none;font-size:18px;">+1</b>')[0];UI.append(a.addOnePop,b);UI.animate(a.addOnePop,"top","-30",function(){UI.remove(a.addOnePop);UI.C(a.addOnePop,"top",0)},0.2);UI.animate(a.addOnePop,"opacity",0,function(){UI.C(a.addOnePop,"opacity",1)},0.2)};MI.TalkList.prototype.repaint=function(b,a){var c=d(b,a);UI.each(c,function(a){a.style.cssText="font-family:Arial";setTimeout(function(){a.style.cssText=""},0)})};MI.TalkList.prototype.showSyncQzone=function(b,a,c){b._syncQzone=b._syncQzone||d(b._body,".replayQzoneCheckbox")[0];if(b._syncQzone){var e=b._syncQzone.parentNode,f;e&&(f=e.parentNode,b.syncQzoneOld=UI.A(a,"syncQzone")?0:1,b.syncQzoneOld?(e.style.display=c?"none":"",f.style.display="",b.data.share=c?0:1*b._syncQzone.checked,b.data.syncQzone=0):(e.style.display="",f.style.display="",b.data.syncQzone=1*b._syncQzone.checked,b.data.share=0))}};MI.TalkList.prototype._iconPicToggle=function(){var b=UI.hasClass(this._body,"iconPic");UI.toggleClass(this._body,"iconPic");this.iconPic=b?0:1;MI.Crs(1);UI.each(d(this._body,".picBox"),function(a){var c=d(a,"a img");if(a=1<c.length?c[1]:c[0])1<c.length&&(""!=a.className&&"preview"!=a.className&&"crs"!=a.className)&&(a=c[0]),c=a.parentNode,"A"==c.nodeName&&c.href&&(c=c.href.replace(/460$/,""),c=b?c+"160":MI.Crs.iconPicUrl,UI.hasClass(a,"crs")?UI.A(a,"crs",c):a.src=c)})};MI.TalkList.prototype.relayListSpecial=0;MI.TalkList.prototype.isBtn=function(b){b=b.nodeName;return"A"==b||"INPUT"==b||"BUTTON"==b};MI.TalkList.prototype.events={"*":function(b,a,c){var e=d(a,".time"),b="";2==e.length&&(e=e[0].href)&&(b=e.match(/[^\/]+$/g)[0].match(/[0-9]*[0-9]/g));c.reportRead({id:MI.string.parseInt(a.id),rid:b,ta:MI.user.account})},"*|tv=2":function(b,a){var c=b.target,e=d(a,".userPic a")[0],e=e?UI.A(e,"href"):!1,f=e.match(/([^\/]+)$/g),e=f&&0<f.length?e.match(/([^\/]+)$/g)[0]:"",f=UI.A(a,"tvs"),g="WBTopAd_",g=UI.hasClass(c,"relay")?g+"relay":UI.hasClass(c,"fav")?g+"fav":UI.hasClass(c,"comt")?g+"comt":UI.hasClass(c,"reply")?g+"reply":UI.hasClass(c,"time")?g+"time":UI.hasClass(c,"url")||"a"==c.tagName.toLowerCase()&&UI.A(c,"shorturl")?g+"url":"a"==c.tagName.toLowerCase()&&c.title&&-1<c.title.indexOf("@")?g+"referto":"a"==c.tagName.toLowerCase()&&/^#[^#]+#/ig.test(c.innerHTML)?g+"topic":UI.hasClass(c,"f")?g+"from":c.parentNode&&"a"==c.parentNode.tagName.toLowerCase()&&UI.hasClass(c.parentNode,"pic")?g+"pic":c.parentNode&&UI.hasClass(c.parentNode,"mask")||UI.hasClass(c.parentNode,"vThumbs")||UI.hasClass(c.parentNode,"vSimple")?g+"video":g+"other";MI.Bos({id:1595,name:g,sBak1:e,sBak2:a.id,iBak1:f})},".relay":function(b,a,c){var e=a.id,f=d(a,".time"),g=UI.A(a,"data-zone")||0,h=d(a,".f")[0];if(c.isBtn(this)&&1!=UI.A(this,"clickE")&&c.collapse(this,1)){UI.A(a,"vmode");c.creatBox(a);if(1==c.isQun){var i=MI.string.parseInt(UI.A(a,"wqid"));c.relayBox.data.wqid=i}if(i=UI.A(a,"qroot"))c.relayBox.data.qroot=i;try{c.curSource=this.href.match(/[^\/]+$/g)[0].match(/[0-9]*[0-9]/g)}catch(m){}c.setArrowX(this,f);c.reply(e||a,1,UI.A(this,"num"));c.replyCont=UI.A(l(e)||a,"cont");c.replyTarget=this;1!=c.type&&(2!=c.type&&4!=c.type&&0==g)&&c.showSyncQzone(c.relayBox,a);MI.user.fun.newRelay2&&c.createComtList(1,e||a);h&&(UI.A(h,"href").match("event.t.qq.com")?(a=UI.A(h,"href").match(/\d+/),c.setData({_actid:a?a[0]:""})):c.setData({_actid:""}));MI.Bos("btnRelay","",0.01)}b.prevent()},".comt":function(b,a,c){var e=a.id,f=d(a,".time"),g=UI.A(a,"data-zone")||0,h=d(a,".f")[0];if(c.isBtn(this)&&1!=UI.A(this,"clickE")&&c.collapse(this,2)){if(MI.user.fun.shieldComt)return MI.showShieldDialog(),!1;UI.A(a,"vmode");c.creatBox(a);if(1==c.isQun){var i=MI.string.parseInt(UI.A(a,"wqid"));c.comtBox.data.wqid=i}if(i=UI.A(a,"qroot"))c.comtBox.data.qroot=i;try{c.curSource=this.href.match(/[^\/]+$/g)[0].match(/[0-9]*[0-9]/g)}catch(m){}c.setArrowX(UI.parents(this,"mFun")[0]||this,f);c.comtBox._relayCheck.checked=!1;c.comtBox._relayCheck.onclick();c.reply(e||a,2,UI.A(this,"num"));c.replyCont=UI.A(l(e)||a,"cont");c.replyTarget=this;1!=c.type&&2!=c.type&&4!=c.type&&0==g?c.showSyncQzone(c.comtBox,a,this):2==c.type||2==g?UI.hide(c.comtBox._relayCheckLabel):UI.show(c.comtBox._relayCheckLabel);c.createComtList(0,e||a);h&&(UI.A(h,"href").match("event.t.qq.com")?(a=UI.A(h,"href").match(/\d+/),c.setData({_actid:a?a[0]:""})):c.setData({_actid:""}));MI.Bos("btnComt")}b.prevent()},".reply":function(b,a,c){var e=a.id,f=d(a,".time");UI.A(a,"data-zone");c.isBtn(this)&&c.collapse(this,3)&&1!=UI.A(this,"clickE")&&(c.creatBox(a),c.setArrowX(UI.parents(this,"mFun")[0]||this,f),c.reply(e||a,0),c.replyCont=UI.A(this,"cont"),c.replyTarget=this,MI.Bos("btnReply"));b.prevent()},".comtOrg":function(b,a){UI.fireEvent(d(a,".comt")[0],"click");MI.Bos("btnComtReply");b.prevent()},".delBtn":function(b,a,c){var e=a.id;1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a);3==c.type?(c.confirm(e,10),MI.Bos("btnNoticeDel")):(c.confirm(e),MI.talkBox&&6==MI.talkBox.type?MI.Bos("btnNotepadDel"):MI.Bos("btnDel"));b.prevent()},".alarm":function(b,a,c){a=a.id;c.isBtn(this)&&(MI.Group&&MI.Group.qid?(c.report(a,this,1,{qid:MI.Group.qid,zone:1}),MI.Bos("btnReport_ qun")):(c.report(a,this),MI.Bos("btnReport")));b.prevent()},".fav":function(b,a,c){var e=a.id;if(c.isBtn(this)&&(!UI.hasClass(this,"light")||UI.A(this,"noLight")))1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.fav(e,this.type),UI.A(this,"noLight",1),b.stop(),MI.Bos("btnFav");b.prevent()},".fav.light":function(b,a,c){a=a.id;c.isBtn(this)&&!UI.A(this,"noLight")&&c.unfav(a);b.prevent()},".upTop":function(b,a,c){var e=a.id;c.isBtn(this)&&!UI.hasClass(this,"light")&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.upTop(e,this.type),b.stop());b.prevent()},".upTop.light":function(b,a,c){var e=a.id;c.isBtn(this)&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.upTop(e,this.type));b.stop();b.prevent()},".shield":function(b,a,c){var e=a.id;c.isBtn(this)&&!UI.hasClass(this,"light")&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),4==this.type&&c.confirm(e,this.type),MI.Bos("btnShield"));b.prevent()},".shield.light":function(b,a,c){var e=a.id;c.isBtn(this)&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.remove(e,this.type));b.stop();MI.Bos("btnUnShield");b.prevent()},".shieldUser":function(b,a,c){if(c.isBtn(this)){var e=d(a,".userName a")[0]||d(a,".msgCnt strong a")[0],f,g;e&&(f=UI.text(e),g=MI.string.id(e.href),MI.ajax({url:MI.url.sFollow,data:{op:5,u:g},success:function(a){var a=MI.json(a),b="";0==a.result&&(a.info&&a.info.special)&&(b='<br><label><input class="check1" type="checkbox" checked>'+_("取消对{0}的特别收听",f)+"</label>");MI.confirm({type:"error",title:_("屏蔽{0}的广播",f),content:'<div id="talkListShieldUser">'+_("主页将不再显示{0}的微博<br>可以在“设置-微博管家”中取消屏蔽",UI.A(e,"gender")||"TA")+b+"</div>",confirm:function(){var a=2,b=d(l("talkListShieldUser"),"input")[0];b&&b.checked&&(a=4);MI.ajax({url:MI.url.sFollow,data:{op:a,u:g},success:function(a){a=MI.json(a);0==a.result?MI.tip(_("屏蔽成功！")):a.msg&&MI.alert(a.msg)}})},cancel:function(){MI.dialog.hide()}})}}),MI.Bos("shieldUser"))}b.prevent()},".shieldFrom":function(b,a,c){c.isBtn(this)&&!UI.hasClass(this,"light")&&(a=d(a,".ico_shield"),a.length&&(a=a[a.length-1],UI.fireEvent(a,"click")),MI.Bos("shieldFrom"));b.prevent()},".privacyBtn":function(b){b.prevent()},".f":function(){var b=d(this.parentNode.parentNode,".time")[0],a=MI.string.id(b.href),b=UI.A(b,"from"),c=UI.A(this,"href");UI.A(this,"urlBoss")||(UI.A(this,"urlBoss",1),c.hasString("http://url.cn")&&UI.A(this,"href",(UI.B.ie?" ":"")+c+"?u="+MI.user.account+"&t="+a+"&msgfrom="+b+"&area=source&clickfrom=3&clickscene="+MI.sceneId()))},".time":function(){"A"==this.nodeName&&MI.Bos("btnTime")},".selectCls .popupDropBtn":function(b,a,c){this.onclick||c.selectFav(this);b.stop();b.prevent()},".replyMsg":function(b,a){var c=a.id;if(MI.talkBox)if(6==MI.talkBox.type)MI.dialog.show({width:560,title:'<h1 class="DmainTit">'+_("修改记事本")+"</h1>",html:l("talkBoxMsg")}),MI.talkBoxMsg._txt.value=UI.text(d(a,".msgCnt")[0]),MI.talkBoxMsg.talkId=MI.string.parseInt(c),MI.talkBoxMsg.countTxt(),MI.talkBoxMsg.successStart=function(b){d(a,".msgCnt")[0].innerHTML=MI.string.html(b.info.talk[0].content);MI.tip(_("修改成功"))},MI.focus(MI.talkBoxMsg._txt),MI.Bos("btnNotepadEdit");else{MI.talkBox._msgTo.value=UI.A(this,"rel");UI.removeClass(MI.talkBox._btn,"btnNoStr");MI.talkBox._txt.value="";MI.talkBox.countTxt();if(MI.dialog){MI.dialog.show({width:560,html:l("talkBoxMsg")});try{setTimeout("MI.talkBox._txt.focus()",0)}catch(e){}MI.talkBox.getMsgTo()}MI.Bos("btnReplyMsg")}b.prevent()},".areaInfo a":function(b,a,c){UI.A(this,"noPop")||(c.geolocation.show(this),MI.Bos("btn_check_location"),b.prevent())},".orderWrap":function(b,a,c){var e=a.id,f;c.cur=e;if(!UI.A(this,"event")){var g=UI.E(b),h=d(a,".time"),g=g.target,i=g.parentNode,m=i.parentNode,x=g.nodeName,k=g,j=this,q=d(j,".orderDetail")[0],o=d(j,"img")[0],h=h[0],t=e;if(q)if(k=UI.A(q,"data-tid")||UI.A(q,"data-sid"))MI.user.fun.topicSidePanel&&!UI.hasClass(a.parentNode,"LC_mini")?(MI.app({MicroTopic:function(){MI.MicroTopic.bindAndTrigger(q)}}),b.prevent()):(e=e.match(/([0-9]{5,})($|\D)/))&&e[1]&&window.open("http://t.qq.com/p/t/"+e[1]);else{k=g.className.hasString("vClose")||i.className.hasString("vClose");h&&h.href&&(t=MI.string.id(h.href));var n=function(){q=d(j,".orderDetail")[0];o=d(j,"img")[0];UI.toggleClass(j,"orderView");o&&UI.hasClass(UI.next(o),"orderInfo")&&(UI.hasClass(o,"goodsPic")||(UI.remove(o.parentNode),UI.prepend(o,q)),UI.addClass(o,"goodsPic"));var a=UI.GT(q,"iframe")[0];if(UI.hasClass(j,"orderView")){if(a)try{a.contentWindow.showCall()}catch(b){}MI.Bos({name:"btnViewOrderDetail",iBak1:UI.A(q,"iframeType"),sBak1:e,id:1192});if(!UI.B.ie6)var g=setInterval(function(){if(!UI.hasClass(a,"loading")){clearInterval(g);if(UI.height(d(l(c.cur),".rich_max")[0])>UI.windowHeight()){MI.TalkList.longWB=MI.TalkList.longWB||{count:0};MI.TalkList.longWB[c.cur]=1;MI.TalkList.longWB.count++}f=l("richCloser");fix=l("nav_fix_wrap");if(!f&&fix){UI.append(UI.html('<div class="richFloat"><a id="richCloser" class="richCloser" title="收起" style="display:none"></div></div>')[0],fix);f=l("richCloser");UI.EA(f,"click",function(a){UI.E(a).prevent();UI.fireEvent(d(l(MI.TalkList.curKey),".orderWrap")[0],"click")});UI.linkEvent.add("windowScroll",function(a){var b;MI.TalkList.longWB=MI.TalkList.longWB||{count:0};MI.TalkList.longWB.count?UI.each(MI.TalkList.longWB,function(c,e){if(e!="count"){b=d(l(e),".rich_max")[0];var g=UI.height(b),h=UI.getY(b);if(h<a.scrollY&&h+g>a.windowHeight+a.scrollY){UI.show(f);MI.TalkList.curKey=e;return true}f&&UI.hide(f)}}):f&&UI.hide(f)})}}},200)}else{MI.Crs.iconPic="x";MI.Crs(1,d(q,".rich_min")[0]);var h=UI.getY(l(c.cur)),i=d(".headShadow")[0],i=i?UI.height(i):0;h<UI.scrollY()+i&&UI.scrollTo(document.body,0,h-i);!UI.B.ie6&&MI.TalkList.longWB&&(MI.TalkList.longWB[c.cur]&&(delete MI.TalkList.longWB[c.cur],MI.TalkList.longWB.count--),f&&UI.hide(f));if(a){try{a.contentWindow.hideCall()}catch(m){}try{a.contentWindow.hideIfr()}catch(x){}}MI.Bos({name:"btnViewOrderDetailHide",iBak1:UI.A(q,"iframeType"),sBak1:e,id:1192})}};if("A"!=x&&"A"!=i.nodeName&&"A"!=m.nodeName||k){if(UI.A(j,"data"))n();else{if("18"==UI.A(q,"iframeType")&&(MI.Bos("btnMiTpcOpen2"),UI.hasClass(a.parentNode,"LC_mini"))){(e=e.match(/([0-9]{5,})($|\D)/))&&e[1]&&window.open("http://t.qq.com/p/t/"+e[1]);return}UI.A(j,"loading")||(MI.ajax({type:"get",url:MI.url.uploadOrder,data:{op:4,type:UI.A(q,"type")||"",iframeType:UI.A(q,"iframeType")||"",url:UI.A(q,"url")||"",msgid:t},success:function(a){a=MI.json(a);UI.A(j,"data",1);UI.A(j,"loading",0);0==a.result&&a.info?(q.innerHTML=a.info,MI.Crs(1,d(q,".rich_max")[0])):0!=a.result&&a.msg&&MI.alert(a.msg);n()}}),UI.A(j,"loading",1))}if(k)return b.prevent(),!1}else("A"==x||"A"==i.nodeName||"A"==m.nodeName)&&MI.Bos("btnViewOrderLink")}}},".ico_shield":function(b,a,c){if(c.isBtn(this)&&MI.user.fun.hasThirdAppShield){var a=UI.A(this,"fromTxt"),e,c=_("确定屏蔽{0}的广播？",a),f="屏蔽后，来自此应用的广播将不再显示",a=d(this.parentNode.parentNode,".time")[0];e=UI.A(a,"from");1811==e&&(c="确定关闭微博推荐功能？",f="关闭微博推荐后，精选出的好友微博将不出现在您的首页");MI.confirm({type:"error",width:320,title:c,content:f,confirm:function(){MI.Bos("shieldPost_confirm");MI.ajax({url:MI.url.thirdappshield,type:"post",data:{type:1,fromid:e},success:function(a){a=MI.json(a);if(a.result==0)if(a.isFirst){a='以后还可以选择<br><a href="###" class="btn_moreSet" onclick="MI.viewSet(\'showModSet\');return false"></a> 或 <a href="http://t.qq.com/blocks.php">设置&gt;屏蔽与黑名单</a> 下取消屏蔽';MI.api.type&&MI.api.type==4&&(a='可以在<a href="http://1.t.qq.com/setting#shield">设置</a>中取消对该应用的屏蔽');MI.confirm({type:"success",title:_("屏蔽成功"),content:a,width:250,confirmTxt:"",cancelTxt:"知道了",cancel:function(){setTimeout(function(){location.reload()},100)}})}else{MI.tip(_("屏蔽成功！"));setTimeout(function(){location.reload()},100)}}})}});MI.Bos("btn_clickShieldIcon")}b.prevent()},".eventPic":function(){var b=UI.A(this,"eventId");if(!b)return!1;MI.app({TalkBoxRich:function(){MI.sendGiftShow(b)}});return!1},".tl_prepic_lk":function(b,a){var c=[];UI.each(d(a,".tl_imgGroup_link img"),function(a,b){c.push(a.src.replace(/\/\d+$/g,""));UI.A(a,"i",b)});MI.cPlayer.load2Show(a.id,0,c);MI.Bos("btnPicGroup");b.prevent()},".tl_imgGroup_link img":function(b,a){var c=0,e=[],f=this;UI.each(d(a,".tl_imgGroup_link img"),function(a,b){e.push(a.src.replace(/\/\d+$/g,""));UI.A(a,"i",b);a===f&&(c=b);UI.A(a,"i",b)});MI.cPlayer.load2Show(a.id,c,e);MI.Bos("btnPicGroup");b.prevent();return!1},".cap_panel":function(b,a){var c=MI.string.id(UI.A(d(a,".userName a")[0],"href"));MI.user.account!=c&&(MI.Bos("wideBirthTimeline"),MI.app({TalkBoxRich:function(){MI.sendGiftShow({userAccount:c,nick:UI.text(d(a,".userName a")[0]),giftType:1,successCall:function(){MI.Bos("TimelineBirthSuccess")}})}}));b.prevent()},"a.detail":function(){MI.Bos("btnViewDetail")},".readNum":function(b,a,c){var e=b.target,f=/([0-9]{5,})($|\D)/,d;b.prevent();if((b=e&&e.href&&e.href.match(f))&&b[1]){b=b[1];if(c._collapseTarget===a&&5===c._collapseType&&c.showReadList._openByMo){c._collapseTarget=e;c.showReadList._openByMo=!1;return}c.collapse(e,5)&&(c.showReadList._openByMo=!1,c.showReadList(b,function(a,b){UI.after(a,e.parentNode.parentNode);d=e.innerHTML.match(RegExp("([0-9.]+)("+_("万")+"?)"));d[2]&&(b=1E5<b?Math.floor(b/1E4):Math.floor(b/1E3)/10);if((d=d&&d[1])&&d<b)e.innerHTML=e.innerHTML.replace(d,b)}))}MI.Bos("btnReadNum")},".int_like":function(b,a,c){var a=b.target,e,f,d;b.prevent();for(f=a;f&&!f.href;)f=f.parentNode;f&&(e=(e=f.href.match(/([0-9]+)/))&&e[1]);if(e)if(UI.hasClass(a,"ico_likeb"))c.like(e,a);else if(UI.hasClass(a,"ico_likea"))c.like.unlike.apply(c,[e,a]);else{for(d=a;d&&!UI.hasClass(d,"pubInfo");)d=d.parentNode;(UI.hasClass(f,"num_likeb")||UI.hasClass(f,"int_havelike"))&&c.collapse(f,6)&&c.like.showList.apply(c,[e,function(a,b){var c=UI.GC(f,"span")[0],e=parseInt(c.innerHTML,10);UI.after(a,d);if(b!==e)c.innerHTML=b}])}},".picTools .btnMobile":function(b){var a=UI.A(this,"codeurl"),c=UI.parents(this,"picBox")[0],e=d(c,".pic")[0],f=UI.height(e),g=280<f?f:280,h=d(c,".shade"),i=function(a){UI.hide(a);UI.removeClass(c,"pic_shade_pn")};MI.app({Tmpl:function(){if(h.length)h=h[0];else{h=UI.html(MI.tmpl.picCode)[0];var b=d(h,".picUrl")[0];UI.EA(b,"load",function(){UI.removeClass(b.parentNode,"loading")});b.src="http://api.t.qq.com/asyn/getPRCode.php?url="+a+"&size=5&margin=1";var f=d(h,".shade_close_in")[0];f&&(f.onclick=function(){MI.Bos("btnPicCodeClose");i(h);return!1});UI.after(h,e)}h.style.height=g+"px";UI.EA(h,"click",function(){i(h)});"none"!=h.style.display?i(h):(UI.addClass(c,"pic_shade_pn"),UI.show(h),MI.Bos("btnPicCodeShow"))}});MI.Bos("btnMobileToPic");b.prevent()}};MI.TalkList.prototype._addEvent=function(b){var a=this,c=b.id;d(b,".time");var e=d(b,".zfNum"),f=e[e.length-1],g=d(b,".zfNum2")[0],h=d(b,".at_stranger")[0],i,e=d(b,".msgCnt")[0];d(b,".replyBox");var m=d(b,".mFun a")[0],x=d(b,".btn_trans"),k=d(b,".url"),j=d(b,".fileBox"),q=d(b,".musicBox,.musicAlbum"),o=d(b,".voteBox"),t=d(b,".relayList")[0],n=UI.A(b,"data-zone")||0,s=t?UI.A(t,"vmode"):0,w=d(b,".ico_shield"),E=d(b,".msgCnt .ic_pic");d(b,".readNum");f||(s=0,t&&UI.hide(t));s&&UI.A(b,"vmode",s);a.tips_relay=_("由于用户设置，你无法转播此微博");a.tips_com=_("由于用户设置，你无法评论此微博");MI.user.fun.wideStyle&&0!==this.useSidePanel&&(MI.sidePanelUserProfile(d(b,".msgBox strong a,.msgBox em a,.msgBox .uList_tbst li a,.msgBox .mod_tl_recom p a.BossHref,.userPic a")),MI.sidePanelTopicProfile(d(b,".msgCnt a")));!a.apiType&&MI.api.type&&(a.apiType=MI.api.type);MI.user.fun.hasThirdAppShield&&w.length&&UI.each(w,function(a){var b=d(a.parentNode,".f")[0],c="";if(b)c=b.innerHTML;UI.A(a,"fromTxt",c);UI.A(a,"title",_("不再显示{0}的广播",c))});if(f&&!f.innerHTML.hasString(_("对话"))||s){var v,S,y,r,p="",B,u=function(){a.msgMode=0;var b="";a.apiType&&(b=b+("&apiType="+a.apiType));MI.ajax({url:this.href,type:"get",data:b,success:function(a){O(a)}});a.relayListPosition();return false},O=function(f){var e=UI.A(b,"vmode"),g=UI.A(v,"vmode"),h=relayBoxTmp="relayListBox";if(a.relayListMulti){h="relayListBox_"+c;relayBoxTmp="relayListBox_"+c}f=MI.json(f);if(!y.parentNode||!y.parentNode.parentNode){a.relayListMulti&&(p=c);a.relayListCreate(p,e);var i=v;v=a["_relayList"+p];S=a["_relayListLoad"+p];y=a["_relayListCont"+p];i.parentNode&&UI.replace(v,i);y=d(v,".cont")[0];S=d(v,".loading")[0]}if(UI.A(b,"rumor")&&r){r.innerHTML='<div class="lie c_tx4 cSign">'+_("此微博未经证实，请谨慎转播")+"</div>";UI.show(r)}else UI.hide(r);if(!e&&f.result!=0){f.msg&&MI.alert(f.msg);a.relayListHide()}else{UI.hide(S);!g&&!a.relayListMulti&&UI.remove(a[h]._body);if(!g){if(UI.B.ie&&a[h]&&a[h]._body){if(!a._relayListHideContainer)a._relayListHideContainer=document.createElement("div");UI.append(a[h]._body,a._relayListHideContainer)}y.innerHTML=f.info}UI.show(y);g||UI.evalScript(f.info);UI.hide(d(y,".nfunTips")[0]);g=d(y,".pages a,.tabStyle1 a");UI.each(g,function(a){if(!UI.A(a,"target"))a.onclick=u});g=d(y,"ul.clear li");if(g.length){a.type!=1&&(a.type!=2&&a.type!=4)&&UI.addClass(g[g.length-1],"nobor");UI.each(g,function(f){f.onmouseover=function(){UI.addClass(this,"subHover");UI.B.safari&&a.repaint(this,".alarm")};f.onmouseout=function(){UI.removeClass(this,"subHover")};a.relayListMulti&&UI.A(f,"id",MI.string.parseInt(f.id)+"_relay");var g=d(f,".relayCite")[0],i=d(f,".replyCite")[0],m=d(f,".alarm")[0];if(g)g.onclick=function(){if(a.relayListMulti){h="relayListBox_"+c;relayBoxTmp="relayListBox_"+c}a[relayBoxTmp].guideText=null;UI.show(a[relayBoxTmp]._body);UI.addClass(a[relayBoxTmp]._body,"zfWrap");UI.hasClass(a[relayBoxTmp]._body,"comtWrap")&&UI.removeClass(a[relayBoxTmp]._body,"comtWrap");UI.removeClass(a[relayBoxTmp]._txt,"cNote");a.getRelayOld(f,".content",a[relayBoxTmp]);a[relayBoxTmp].txtTipSend=_("转播中");a[relayBoxTmp]._btn.value=_("转播");if(a.type!=1&&a.type!=2&&a.type!=4&&n==0){a.showSyncQzone(a[relayBoxTmp],b);UI.next(a[relayBoxTmp]._syncQzone).innerHTML=a[relayBoxTmp]._btn.value}if(a[relayBoxTmp]._syncQzone&&a[relayBoxTmp]._syncQzone.parentNode.style.display!="none"&&UI.A(f,"from")=="10")a[relayBoxTmp]._syncQzone.checked=true;a[relayBoxTmp].talkId=MI.string.parseInt(f.id);a[relayBoxTmp]._relayCheck.checked=true;a[relayBoxTmp]._relayCheck.onclick();(a.type==1||a.type==4)&&UI.hide(a[relayBoxTmp]._relayCheckLabel);UI.A(y,"fRt")?q(a[relayBoxTmp],1,a.tips_relay):q(a[relayBoxTmp],0);return false};if(i)i.onclick=function(){if(MI.user.fun.shieldComt){MI.showShieldDialog();return false}if(a.relayListMulti){h="relayListBox_"+c;relayBoxTmp="relayListBox_"+c}if(e){h="relayListBox_"+c;relayBoxTmp="relayListBox_"+c}a[relayBoxTmp].guideText=null;UI.show(a[relayBoxTmp]._body);UI.addClass(a[relayBoxTmp]._body,"zfWrap");UI.addClass(a[relayBoxTmp]._body,"comtWrap");UI.removeClass(a[relayBoxTmp]._txt,"cNote");a.getRelayOld(f,".content",a[relayBoxTmp]);a[relayBoxTmp].txtTipSend=_("评论中");a[relayBoxTmp]._btn.value=_("评论");if(a.type!=1&&a.type!=2&&a.type!=4&&n==0){a.showSyncQzone(a[relayBoxTmp],b,1);UI.next(a[relayBoxTmp]._syncQzone).innerHTML=a[relayBoxTmp]._btn.value}if(a[relayBoxTmp]._syncQzone&&a[relayBoxTmp]._syncQzone.parentNode.style.display!="none"&&(UI.A(y,"isvip")||UI.A(f,"from")=="10"))a[relayBoxTmp]._syncQzone.checked=true;a[relayBoxTmp].talkId=MI.string.parseInt(f.id);a[relayBoxTmp]._relayCheck.checked=false;a[relayBoxTmp]._relayCheck.onclick();(a.type==1||a.type==4)&&UI.show(a[relayBoxTmp]._relayCheckLabel);UI.A(y,"fCom")?q(a[relayBoxTmp],1,a.tips_com):q(a[relayBoxTmp],0);return false};if(m)m.onclick=function(b){MI.Group&&MI.Group.qid?a.report(f.id,this,1,{qid:MI.Group.qid,zone:1}):a.report(f.id,this);UI.E(b).stop();return false}})}if(MI.user.fun.rtPicPub){g=d(y,".msgCnt .ic_pic");g.length&&UI.each(g,function(a){a.onmouseover=function(){MI.TalkList._showPicPreview(a)}})}try{var m=d(v,".num")[0],E,o=d(B,".relayNum")[0],x=d(v,".num2")[0],k,j=d(b,".relayNum")[1];if(m){E=m.innerHTML;if(E==0&&d(v,"ul li").length==0){UI.hide(d(v,"ul")[0]);UI.hide(d(v,".pages")[0])}if(E>parseInt(o.innerHTML))o.innerHTML=E}if(x&&j){k=x.innerHTML;if(k>parseInt(j.innerHTML))j.innerHTML=k}}catch(t){}if(m=d(y,".relayThumb")[0]){m.onclick=C;m.onclick()}y.onclick=function(){MI.DisableDblClickSelect(this)};a.buildTips(v);if(MI.user.fun.wideStyle&&this.useSidePanel!==0){MI.sidePanelUserProfile(d(v,".msgCnt strong a,.msgCnt em a,.cNote2 a,.more a"));MI.sidePanelTopicProfile(d(v,".content a"))}MI.app({Base:function(){MI.Card.build(v,".msgCnt strong a,.msgCnt em a,.cNote2 a,.more a",2)}});MI.Crs(1);a.relayListCall&&a.relayListCall(v);MI.PV("relay");(!location.hostname||location.hostname!="qun.t.qq.com")&&UI.removeClass(a[h]._body,"comtWrap");var q=function(a,b,c){if(b){a._txt.disabled=true;a._btn.disable=1;UI.addClass(a._btn,"btnNoStr");a.showTip(c,1);a.flashTip();a.tipNoChange=1}else{a.tipNoChange=0;a._txt.disabled=false;a._btn.disable=0;UI.removeClass(a._btn,"btnNoStr");a.countTxt()}};UI.A(y,"isvip",f.isvip?1:0);if(f.attr){UI.A(y,"fCom",f.attr.fCom?f.attr.fCom:0);UI.A(y,"fRt",f.attr.fRt?f.attr.fRt:0);f.attr.fRt?q(a[h],1,a.tips_relay):q(a[h],0)}else{UI.A(y,"fCom",0);UI.A(y,"fRt",0);q(a[h],0)}f=UI.A(b,"type")=="10"?1:0;if(a[relayBoxTmp]._syncQzone&&a[h]._syncQzone.parentNode.style.display!="none")a[h]._syncQzone.checked=f?true:false}},C=function(){UI.hide(this);var f,e=1,g="relayListBox",h="relayBox";f=UI.A(b,"vmode");var i=UI.A(v,"vmode"),m=UI.A(this,"appended"),E=this.parentNode;if(a.relayListMulti){g="relayListBox_"+c;h="relayBox"}if(a.type==1||a.type==2||a.type==4||n==2||f)e=0;if(m)UI.show(this.nextSibling);else{a.creatBox(b);d(y,".relayThumb");if(a.isQun==1){f=MI.string.parseInt(UI.A(b,"wqid"));a[g].data.wqid=f}f=MI.string.parseInt(UI.A(b,"qroot"));a[g].wqRootId=f;a[g]._txt.value="";a[g].countTxt();a[g]._relayCheck=d(a[g]._body,".check1")[0];a[g]._relayCheckLabel=a[g]._relayCheck.parentNode;a[g].successStart=function(){var b=d(y,".refreshBth")[0];if(b)b.onclick();if(!MI.Nano)if(a[g].type==1){MI.tip(_("转播成功！"));MI.Bos("btnSendRelayList")}else{MI.tip(_("评论成功！"));MI.Bos("btnSendComtList")}a.updateRelayNum(a[g].type)};a[g].start=function(){clearTimeout(void 0)};f=a[g]._body;var o=function(){UI.ER(E,"click",o);UI.replace(a[g]._body,d(E,".zfWrap")[0]);setTimeout(function(){a[g].countTxt();MI.selectTxt(a[g]._txt,0,0,0)},100)};i?UI.EA(E,"click",o):UI.after(f,this);a[g]._body.ondblclick=function(a){UI.E(a).stop()};if(!UI.B.ie)a[g]._body.onmousedown=function(a){UI.E(a).stop()};a[g]._relayCheck.onclick=function(){var b=this.checked;a[g].type=b?1:4;a[g]._tip.innerHTML="";a[g].countTxt();a[g].addList=b?a[h].addList:0;MI.Bos("btnRelayistCheckbox")};i||UI.A(this,"appended",1);if(!a.relayListMulti)a.talkBox=a[g]}if(MI.user.fun.relayListBoxCondensed){UI.addClass(a[g]._body,"condensed");a[g].guideTextAdd(e?_("点击转播"):_("点击评论"))}else i||setTimeout(function(){a[g].focus()},100);if(!e){UI.addClass(a[g]._body,"comtWrap");a[g]._relayCheck.checked=false;UI.show(a[g]._relayCheckLabel)}a[g].txtTipSend=e?_("转播中"):_("评论中");a[g]._btn.value=e?_("转播"):_("评论");a[g].addList=e?a.relayBox.addList:0;if(a.type==2||n==2){a[g].addList=1;UI.hide(a[g]._relayCheckLabel)}a[g].talkId=MI.string.parseInt(c);a[g].type=e?1:4;a[g].apiType=a.apiType;a[g].iconPic=a.iconPic;a[g].autoHeight=30;if(a.type!=1&&a.type!=2&&a.type!=4&&n==0){a.showSyncQzone(a[g],b,!e);UI.next(a[g]._syncQzone).innerHTML=a[g]._btn.value}},t=function(e,g){e=e||window.event;if(!a.collapse(this,4))return false;if(e){var h=UI.E(e),i=h.type;a.msgMode=i?0:1}var g=g?g:this,m=UI.A(b,"vmode"),E=UI.A(b,"data-zone")||0;if(!v){a.relayListMulti&&(p=c);(!a["_relayList"+p]||a.relayListMulti)&&a.relayListCreate(p,m);v=a["_relayList"+p];S=a["_relayListLoad"+p];r=a["_relayListTips"+p];y=a["_relayListCont"+p]}r&&UI.hide(r);var m=UI.A(v,"vmode"),o=d(y,".pages .left")[0];if(m)o.onclick=function(){if(UI.A(this,"expand"))return true;f.onclick();UI.A(this,"expand",1);return false};a.xhr.relay&&!a.relayListMulti&&a.xhr.relay.abort();var x=MI.string.id(g.href),o=x==c?x:c;UI.windowHeight();var k,j,q,t,n,ga;if(a.relayListOption){j={};for(k in a.relayListOption)j[k]=a.relayListOption[k]}UI.A(g,"rel",x);B=g;if((!a.relayAtCur||!j)&&(i&&!a.relayListSpecial||!i&&a.relayListSpecial)&&v.display=="1"&&(a.cur==o||a.relayListMulti)&&!m)d(v,".w_close")[0].onclick();else{UI.removeClass(l(a.cur),"cur");UI.remove(a._confirm);a.replyHide();a.talkBox&&a.talkBox.hide();if(!m){UI.hide(y);UI.show(S)}UI.append(v,d(b,".msgBox")[0]);a.hideComtReply(b);q=+new Date;var s=MI.url.relayList,x={id:x,viewModel:a.iconPic};if(a.apiType)x.apiType=a.apiType;if(a.type==2||E==2)x.zone=2;if(j){if(j.url)s=j.url;if(j.data)for(k in j.data)x[k]=j.data[k]}if(a.isReply)x.isReply=1;if(m){O("",b);UI.A(v,"vmode",0)}else a.xhr.relay=MI.ajax({url:s,type:"get",data:x,success:function(a){t=+new Date-q;O(a);j&&j.call&&j.call();n=+new Date-q;setTimeout(function(){ga=+new Date-q;MI.Speed("t_asyn_relay",0.1,t,n,ga)},0)}});k=UI.scrollY();(E=UI.getY(g))&&E<k&&window.scrollTo(0,E);if(!m){UI.addClass(b,"cur");a.cur=o;v.display=1}MI.Bos("btnViewRelay",o)}a.relayListPosition=function(){var a=UI.getY(f);a&&UI.scrollY()>a&&window.scrollTo(0,a)};try{!m&&a.focus()}catch(ua){}h&&h.stop();if(i)a.relayListSpecial=0;a.relayListOption=null;UI.linkEvent("MI.TalkList.resize");return false};s&&t("",f);f.onclick=t;a.viewRelayToMsg&&(f.onclick=null);a.viewRelayUseContainer&&(f.onclick=a.viewRelayUseContainer)}g&&"A"==g.nodeName&&(g.onclick=function(){a.relayListSpecial=1;if(a.relay2Cur&&a.relay2Cur==this)a.relayListHide();else{a.relayListOption={url:MI.url.relayListSecond,data:{id:c},call:function(){}};if(v)v.display=0;if(f)f.onclick();a.relay2Cur=this}MI.Bos("btnViewRelay2");return false});h?d(h,"a")[0].onclick=function(){var b=this;a.relayListOption={url:MI.url.relayListAt,data:{type:3,viewModel:a.relayAtModel||0},call:function(){var a=d(b,"em")[0],c;if(a)if(c=UI.A(b,"num")){a.innerHTML="("+c+")";UI.addClass(a,"checked")}else a.innerHTML=""}};if(a.collapse(this,4)){if(v)v.display=0;if(f)f.onclick();a._collapseTarget=this}MI.Bos("btnViewRelayAt");return false}:i=d(b,".at_detail")[0];i&&UI.each(d(i,"a"),function(b){b.onclick=function(){a.relayListSpecial=2;a.relayListOption={url:MI.url.relayListAt,data:{type:UI.A(this,"rel")||0,viewModel:a.relayAtModel||0},call:function(){var a=d(b,"em")[0],c;if(a)if(c=UI.A(b,"num")){a.innerHTML="("+c+")";UI.addClass(a,"checked");for(a=b.nextElementSibling;a;){if(c=d(a,"em")[0])c.innerHTML="";a=a.nextElementSibling}}else a.innerHTML=""}};if(a.collapse(this,4)){if(v)v.display=0;if(f)f.onclick();a._collapseTarget=this}MI.Bos("btnViewRelayAt");return false}});if(m){i=m.parentNode;var z,A;m.onclick=function(f){clearTimeout(z);var e=this;A=setTimeout(function(){a.moreFun(e.parentNode,c||b);MI.Bos("btnMoreFun",null,0.01)},150);if(UI.hasClass(e.parentNode,"mFunDis")){UI.hasClass(document.body,"ipad")&&setTimeout(function(){UI.removeClass(e.parentNode,"mFunDis")},200);UI.E(f).stop()}var f=d(b,".fav")[0],g=d(b,".upTop")[0],h=d(b,".shield")[0],i=d(b,".privacyBtn")[0],m;m=UI.hasClass(f,"light");if(f){f.type=m?3:1;f.innerHTML=m?_("取消收藏"):_("收藏")}m=UI.hasClass(g,"light");if(g){g.innerHTML=m?_("取消置顶"):_("置顶");g.type=m?9:8}m=UI.hasClass(h,"light");if(h){h.type=m?5:4;h.innerHTML=m?_("取消屏蔽"):_("屏蔽@提醒")}if(i){i.onmouseover=function(){UI.addClass(d(this,"a")[0],"cur");var a=d(i,".sub_fun")[0];if(a)UI.show(a);else{a=UI.html('<div class="sub_fun" style="min-height:40px;height:40px;"><p><label for="comBtn'+c+'"><input class="check1"'+(UI.A(b,"fCom")?"checked":"")+' type="checkbox" value="" id="comBtn'+c+'" name="com">禁止评论</label></p><p><label for="frtBtn'+c+'"><input class="check1"'+(UI.A(b,"fRt")?"checked":"")+' type="checkbox" value="" id="frtBtn'+c+'" name="relay">禁止转播</label></p></div>')[0];UI.append(a,this);a.onclick=function(a){UI.E(a).stop()};UI.each(d(a,"input"),function(a){a.onclick=function(f){var e=UI.A(a,"name"),d=MI.url.myViewSettingSave,g={messageid:c,r:MI.random()};if(e=="com")g.commentset=a.checked?1:0;else if(e=="relay")g.relayset=a.checked?1:0;var h=a.checked?1:0;MI.ajax({url:d,type:"post",data:g,success:function(){e=="com"?UI.A(b,"fCom",h):e=="relay"&&UI.A(b,"fRt",h)}});UI.E(f).stop()}})}};i.onmouseout=function(){UI.removeClass(d(this,"a")[0],"cur");var a=d(i,".sub_fun")[0];a&&setTimeout(function(){UI.hasClass(d(i,"a")[0],"cur")||UI.hide(a)},150)}}return false};UI.hasClass(document.body,"ipad")||(m.onmouseover=m.onclick,m.onmouseout=function(){clearTimeout(A)},i.onmouseover=function(){clearTimeout(z)},i.onmouseout=function(){z=setTimeout(function(){clearTimeout(A);a.moreFunHide()},100)})}UI.each(x,function(b){b.onclick=function(){a.trans.show(this);return false};b.onmouseover=function(){a.trans.show(this);return false};b.onmouseout=function(){a.trans.hide();return false}});e&&""==e.innerHTML&&!MI.user.fun.apolloStyle&&(e.innerHTML="&nbsp;");if(MI.user.fun.urlPreview&&k.length)UI.A(b,"preview")||UI.each(k,function(b){a.urlPreview.showPreview(b);return false}),UI.A(b,"preview",1);else if(MI.user.fun.wideStyle&&(MI.user.fun.wideUrlPreview&&0!==a.useSidePanel&&k.length)&&!("e.t.qq.com"==window.location.hostname||"qun.t.qq.com"==window.location.hostname))UI.A(b,"preview")||UI.each(k,function(c){a.urlPreview.addPreviewIconWide(c,b);return false}),UI.A(b,"preview",1);q&&this.musicEvent(q);o&&this.voteEvent(o);j&&UI.B.win&&MI.TalkList.fileEvent(j,b);E&&UI.each(E,function(a){a.onmouseover=function(){MI.TalkList._showPicPreview(a)}})};MI.TalkList.prototype.createComtList=function(b){var a=this,c=function(b,c,f,e){b&&((b._syncQzone&&("none"!=b._syncQzone.parentNode.style.display&&e)&&(b._syncQzone.checked=!0),b._txt.disabled=!1,b._btn.disable=0,UI.removeClass(b._btn,"btnNoStr"),f)?1==b.display&&(a.tips_relay||(a.tips_relay=_("由于用户设置，你无法转播此微博"),a.tips_com=_("由于用户设置，你无法评论此微博")),b._txt.disabled=!0,b._btn.disable=1,UI.addClass(b._btn,"btnNoStr"),c=c?a.tips_relay:a.tips_com,b._relayCheckLabel&&UI.hide(b._relayCheckLabel),b.showTip(c,1),b.flashTip(),b.tipNoChange=1):(b.tipNoChange=0,b.countTxt(),b._relayCheckLabel&&UI.show(b._relayCheckLabel)))};if(a.comtBoxList){var e=a.cur,f=l(e);UI.A(f,"vmode");var g=UI.A(f,"data-zone")||0,h=b?a.relayBox:a.comtBox,i=b?a.relayBox._relayList:a.comtBox._relayList,m=d(f,".comt")[0],x=d(f,".relay")[0],k=d(f,".replyBox")[0],j,q=function(){var c={t:b?1:2};a.apiType&&(c.apiType=a.apiType);MI.ajax({url:this.href,type:"get",data:c,success:function(a){o(a)}});return!1},o=function(e){e=MI.json(e);if(0==e.result){i.innerHTML=e.info;(b&&k||!b)&&UI.show(i);UI.evalScript(e.info);var j=e.isvip?1:0;isAnony="10"==UI.A(f,"from")?1:0;isCheck=j&&!b||isAnony;UI.A(f,"isvip",j);e.attr?(UI.A(f,"fCom",e.attr.fCom?e.attr.fCom:0),UI.A(f,"fRt",e.attr.fRt?e.attr.fRt:0),e.attr.fRt&&b||e.attr.fCom&&!b?c(h,b,1,isCheck):c(h,b,0,isCheck)):(UI.A(f,"fCom",0),UI.A(f,"fRt",0),c(h,b,0,isCheck));if(e=d(i,".num,.num2")[0])if(e=e.innerHTML)if(j=d(a.relayBox._body,".number a")[0],numTarget=b?x:m,j&&(j.innerHTML=j.innerHTML.replace(/\d+/g,e),UI.A(numTarget,"num",e)),MI.user.fun.newRelay2&&k)numTarget.innerHTML=numTarget.innerHTML.replace(/\d+/g,e),UI.A(numTarget,"num",e),numTarget.title&&(numTarget.title=numTarget.title.replace(/\d+/g,e));e=d(i,".pages a,.tabStyle1 a");UI.each(e,function(a){if(!UI.A(a,"target"))a.onclick=q});e=d(i,"li");e.length&&(MI.PV("comt"),UI.addClass(e[e.length-1],"nobor"),UI.each(e,function(b){b.onmouseover=function(){UI.addClass(this,"subHover");UI.B.safari&&a.repaint(this,".alarm")};b.onmouseout=function(){UI.removeClass(this,"subHover")};try{var e=d(b,".relayCite")[0],i=d(b,".replyCite")[0],m=d(b,".alarm")[0];if(e)e.onclick=function(){UI.addClass(h._body,"zfWrap");if(a.type==1||a.type==2||a.type==4||g){UI.hasClass(h._body,"talkWrap")&&UI.removeClass(h._body,"talkWrap");UI.hide(h._relayCheckLabel)}UI.hasClass(h._body,"comtWrap")&&UI.removeClass(h._body,"comtWrap");UI.removeClass(h._txt,"cNote");a.getRelayOld(b,".content",h);h.txtTipSend=_("转播中");h._btn.value=_("转播");h._btn.title=_("转播");if(a.type!=1&&a.type!=2&&a.type!=4&&g==0){a.showSyncQzone(h,f);UI.next(h._syncQzone).innerHTML=h._btn.value}h.type=1;h.talkId=MI.string.parseInt(b.id);var e=UI.A(b,"from")=="10"?1:0;UI.A(f,"fRt")?c(h,1,1,e):c(h,1,0,e);return false};if(i)i.onclick=function(){if(MI.user.fun.shieldComt)MI.showShieldDialog();else{UI.addClass(h._body,"zfWrap");UI.addClass(h._body,"comtWrap");UI.removeClass(h._txt,"cNote");a.getRelayOld(b,".content",h);h.txtTipSend=_("评论中");h._btn.value=_("评论");h._btn.title=_("评论");if(a.type!=1&&a.type!=2&&a.type!=4&&g==0){a.showSyncQzone(h,f,1);UI.next(h._syncQzone).innerHTML=h._btn.value}else UI.show(h._relayCheckLabel);h.type=5;h.addList=a.comtBox.addListTmp;h.talkId=MI.string.parseInt(b.id);var e=UI.A(f,"isvip"),d=UI.A(b,"from")=="10"?1:0,e=e||d;UI.A(f,"fCom")?c(h,0,1,e):c(h,0,0,e)}return false};if(m)m.onclick=function(c){a.report(b.id,this,k?2:1);UI.E(c).stop();return false}}catch(j){}}));MI.user.fun.rtPicPub&&(e=d(i,".msgCnt .ic_pic"),e.length&&UI.each(e,function(a){a.onmouseover=function(){MI.TalkList._showPicPreview(a)}}));i.onclick=function(){MI.DisableDblClickSelect(this)};i.ondblclick=function(){var b=0;UI.each(d(i,".pages a"),function(a){a.innerHTML.hasString(_("下一页"))&&(b=a)});if(b)b.onclick();else{h.hide();a.replyHide()}};UI.B.ie&&(i.onmousedown=function(){i.onselectstart=null},i.onmouseup=function(){i.onselectstart=function(){return false}});a.buildTips(i);MI.user.fun.wideStyle&&0!==this.useSidePanel&&(MI.sidePanelUserProfile(d(i,".msgCnt strong a,.msgCnt em a,.cNote2 a,.more a")),MI.sidePanelTopicProfile(d(i,".content a")));MI.app({Base:function(){MI.Card.build(i,".msgCnt strong a,.msgCnt em a,.cNote2 a,.more a",2)}});MI.Crs(1);a.relayListCall&&a.relayListCall(i)}},t,n,s,p;t=+new Date;a.xhr.comt&&a.xhr.comt.abort();b&&(UI.addClass(h._body,"zfWrap"),UI.hasClass(h._body,"comtWrap")&&UI.removeClass(h._body,"comtWrap"),h.txtTipSend=_("转播中"),h._btn.value=_("转播"),h._btn.title=_("转播"),h.type=1,h.addList=h.addListTmp);i.innerHTML="";UI.hide(i);e={t:b?1:2,id:MI.user.fun.newRelay2&&k?UI.isElement(e)?e.id:e:a.curSource,viewModel:a.iconPic||0};UI.isArray(e.id)||(e.id=MI.string.parseInt(e.id));if(2==a.type||2==g)e.zone="2";a.apiType&&(e.apiType=a.apiType);a.isReply&&(e.isReply=1);a.xhr.comt=MI.ajax({url:MI.user.fun.newRelay2&&k?MI.url.relayListSecond:MI.url.relayList,type:"get",data:e,success:function(a){n=+new Date-t;setTimeout(function(){o(a)},0);s=+new Date-t;setTimeout(function(){p=+new Date-t;MI.Speed("t_asyn_comt",0.1,n,s,p)},100)}});j=UI.scrollY();(e=UI.getY(b?x:m))&&e<j&&window.scrollTo(0,e);h.successStart=function(){a.updateRelayNum();UI.hide(i);var b=d(i,".refreshBth")[0];if(b)b.onclick()}}else e=b?a.relayBox:a.comtBox,j=a.isvip?1:0,a.comtForbidden&&!b||a.frtForbidden&&b?c(e,b,1):c(e,b,0,j)};MI.TalkList.prototype.reply=function(b,a,c){function e(){var a=g.id;f.talkBox.talkId=isNaN(MI.string.parseInt(a))?a:MI.string.parseInt(a)}var f=this,g=l(b);UI.A(g,"vmode");var h=UI.A(g,"data-zone")||0;MI.card&&UI.remove(MI.card._body);f.relayListHide(b);if(f.talkBox&&f.replyTarget&&(UI.A(f.replyTarget,"cont",f.talkBox._txt.value),1==a||2==a)){var i=UI.parents(f.replyTarget,"msgBox")[0];i&&(i=i.parentNode,UI.A(i,"cont",f.talkBox._txt.value))}f.talkBox=2==a?f.comtBox:a?f.relayBox:f.replyBox;f.talkBox.apiType=f.apiType;f._talk=f.talkBox._body;f.talkBox.iconPic=f.iconPic;f.talkBox.startTime=0;UI.C(f.talkBox._txt,"height","");UI.removeClass(f.talkBox._btn,"disabled");UI.removeClass(f._talk,"pubSuc");if(f.talkBox.display)f.talkBox.hide(),f.replyHide(),(1==a||2==a)&&UI.A(g,"cont",f.talkBox._txt.value);else{var i=b,m=f.cur,j=d(g,".zfNum")[0],k=d(g,".userName a")[0]||d(g,"strong a")[0],n="",q,o;d(g,".userName .vip");d(g,".userName .ico_expo");o="";var t=d(g,".msgCnt")[0],s=t?t.cloneNode(1):UI.DC("b"),p=d(g,".replyBox")[0],t=d(g,".replyBox .msgCnt")[0];d(g,".userPic");var r=f.talkBox._txt;k&&(n=k.innerHTML,o=k.title||UI.A(k,"rel"));j&&(i=j.href.match(/[^\/]+$/g)[0]);j=UI.text(s);t&&(k=UI.text(t).split(":"),a&&(q=n,n=k[0]),k=k.slice(1).join(":"));m&&UI.removeClass(l(m),"cur");UI.addClass(g,"cur");f._relayNum=a?d(g,".relayNum"):null;m="";k=_("对话是半公开的，不会出现在你听众的主页上，但是可以到你的页面看到<br>对 <b>{0}</b> 说:",n);m+=_("<br>顺便说两句:");k=2==a?"":a?m:k;if(m=d(f._talk,".replyTitle")[0])m.innerHTML=k;f.talkBox._body.className=2==a?"talkWrap comtWrap bgr3":(a?"zfWrap":"talkWrap")+" bgr3";o=MI.string.account(o);p&&q&&(1==a||2==a)&&!d(g,".view")[0]?(f.talkBox._addReply.innerHTML='&nbsp;<a href="#">['+(1==a?_("清空转播理由"):_("清空评论"))+"]</a>",f.talkBox._addReply.txt=" || @"+o+": "+UI.trim(j),UI.show(f.talkBox._addReply)):UI.hide(f.talkBox._addReply);f.talkBox.talkId=isNaN(MI.string.parseInt(b))?b:MI.string.parseInt(b);f.talkBox.type=a?1:2;!f.comtBox._relayCheck.checked&&2==a&&(f.talkBox.talkId=MI.string.parseInt(b),f.talkBox.type=5);f.talkBox._txt.value="";f.talkBox.countTxt();(o=d(g,".at_detail")[0])?UI.before(f._talk,o):(o=d(g,".msgBox")[0],UI.append(f._talk,o?o:g));setTimeout(function(){if(!r.disabled){r.focus();f.replyCont?r.value=r.value+f.replyCont:a&&!d(g,".view")[0]&&f.getRelayOld(g,".content,.msgCnt",f.talkBox);if(MI.user.fun.rtPicPub&&(a==1||a==2)){var c=MI.TalkList.rtPics[b],e,h,i;if(f.talkBox._retweetPic&&c&&c[c.key]){e=UI.html('<div class="sendList uploadPicSuccess"><i class="ic ic_pic"></i> [image'+c.key+'] <a href="javascript:;" class="ffsong" title="删除">×</a></div>')[0];h=f.talkBox._rtPicWrap;UI.hide(h);UI.after(e,h);h=UI.GC(e,"a")[0];i=UI.GC(e,"i")[0];h.onclick=function(){c[c.key]=null;f.talkBox._txt.value=f.talkBox._txt.value.replace(RegExp("\\[image"+c.key+"\\]","g"),"");c.key=null;MI.selectTxt(f.talkBox._txt,0,0,0);f.talkBox._resetRtPic();MI.Bos("btnDelRtPics")};UI.A(i,"data-rpid",c.key);UI.A(i,"data-rpurl",c[c.key]);i.onmouseover=function(){MI.TalkList.showPicPreview(i)};f.talkBox._txt.value.hasString("[image"+c.key+"]")||f.talkBox.addTopic(" [image"+c.key+"]");f.talkBox._retweetPic.used=c.key}}f.talkBox.countTxt();MI.selectTxt(r,0,0,0)}},50);if(0!=a){p=1>c?_("转播"):_('转播<i class="l"></i>');j=1>c?_("评论"):_('评论<i class="l"></i>');o="";m=1==a?p:j;p=1==a?"Relay":"Comt";j=1==a?"?filter=5":"?filter=6";if(UI.A(g,"rumor"))o+='<span class="lie c_tx4 cSign">'+(1==a?_("此微博未经证实，请谨慎转播"):_("此微博未经证实，请谨慎评论"))+"</span>";else{if((1==f.type||2==f.type||4==f.type)&&1!=a)m=1>c?_("评论"):_('评论<i class="l"></i>');o+=m+_("原文");m="en_US"==window.MILang?"":m;o=0<c&&(!MI.user.fun.newRelay2||!t)&&2!=f.type&&2!=h?o+(_("，")+'<a href="'+MI.getInternalUrl(1,i,"/"+j)+'" onclick="MI.Bos(\'btn'+p+'View\')" target="_blank">'+(0!=c&&c?_("共{0}条",c)+m:"")+'<em class="ffsong">>></em></a>'):o+(1==a?_("，把它分享给你的听众"):"")}2==a&&f.isReply&&(o=(1>c?_("回复"):_('回复<i class="l"></i>'))+" "+(q||n));f.talkBox._numSon.innerHTML=o}c=1==a?_("转播"):2==a?_("评论"):_("对话");f.talkBox._btn.value=c;f.cur=b;f.talkBox.display=1}if(f.replyBox.display||f.relayBox.display||f.comtBox.display)UI.addClass(l(f.cur),"cur"),UI.B.ie6&&UI.addClass(l(f.cur),"hover"),f.hideComtReply(g);f.setArrow(d(f.talkBox._body,".SA")[0]);f.checkTalkId=UI.isElement(b)?e:function(){};UI.linkEvent("MI.TalkList.resize");f.talkBox.resetRtPic(b)};MI.TalkList.prototype.remove=function(b,a,c){var b=String(b),e=this,f=l(b),g=e.removeUrl,h={},i,m,j,k=UI.A(f,"data-zone")||0;h.id=isNaN(MI.string.parseInt(b))?b:MI.string.parseInt(b);c&&(h.veriCode=c);a&&(8==a||9==a?(g=e.upTopUrl,h.op=8==a?1:2):(g=e.favorUrl,h.op=2>a?1:2));e.mId&&(h.mId=e.mId);if((1==e.type||2==e.type||4==e.type||MI.Group)&&MI.Group.qid)h.time=d(f,".time")[0].rel,h.qid=MI.Group.qid,h.zone=e.type?k?k:e.type:MI.TalkBox.prototype.data.cflag;c=h.id;if(4==a)h={id:c,t:0},g=e.shieldUrl;else if(5==a||6==a)h={id:c,t:1},g=e.shieldUrl;10==a&&(h={id:c,r:h.r},g=e.delNoticeUrl);f.sending||(MI.ajax({url:g,data:h,type:"post",success:function(c){f.sending=0;c=MI.json(c);if(c.result==0){i=d(f,".fav")[0];m=d(f,".shield")[0];j=d(f,".upTop")[0];if(a==1){UI.addClass(i,"light");i.innerHTML=_("取消收藏");i.type=3}else{UI.remove(e._confirm);if(a==4){UI.addClass(m,"light");m.innerHTML=_("取消屏蔽");m.type=5}else if(a==8){UI.addClass(j,"light");j.innerHTML=_("取消置顶");j.type=9;c="http://t.qq.com/"+MI.user.account;c=_("我刚置顶了一条微博，大家来看看吧~")+c+"?preview";MI.talk(_('置顶成功，把我的置顶告诉大家:&nbsp;&nbsp;<span style="color:#999">[最多置顶3条微博]</span>'),c,"50");if(MI.guest)MI.dialog.closeEnd=function(){MI.Bos("btnUpTopClose");MI.goHome("preview")};MI.talk.reply.talkBox.successStart=function(){MI.Bos("btnUpTopSend");MI.tip(_("广播成功!"),function(){MI.goHome("preview")})};MI.Bos("btnUpTop")}else{MI.talkBox&&(!a&&c.info!=7)&&MI.talkBox.countNum(-1);if(a==3){UI.removeClass(i,"light");i.innerHTML=_("收藏");i.type=1}else if(a==5){UI.removeClass(m,"light");m.innerHTML=_("屏蔽@提醒");m.type=4}else if(a==9){UI.removeClass(j,"light");j.innerHTML=_("置顶");j.type=8;MI.guest&&MI.goHome("preview");MI.Bos("btnUnUpTop")}else{e.removeCall&&e.removeCall(b);UI.addClass(f,"delMsg");setTimeout(function(){UI.hasClass(f,"orginCnt")?MI.tip(_("删除成功"),function(){MI.goHome()}):UI.animate(f,"opacity",UI.B.ie9?0.01:0,function(){var a=UI.next(f);if(UI.hasClass(f,"fill-back")&&MI.talkBox){var a=d(f,".msgCnt")[0],b="";if(a){a=a.cloneNode(1);UI.remove(d(a,"strong")[0]);UI.remove(d(a,".mediaWrap")[0]);UI.each(d(a,"em"),function(a){a.innerHTML=UI.A(a,"rel")});b=UI.trim(UI.text(a))}MI.talkBox._txt.value=b;MI.talkBox.countTxt();MI.talkBox._txt.select()}else a&&MI.focus(d(a,".userName a")[0]);UI.remove(f);e.bottom()})},300)}}}}else MI.code.check(c.result)?MI.code.show({msg:c.msg,code:c.info,call:function(c){e.remove(b,a,c)}}):c.msg&&(a==8||a==1||c.result==-15||a==4)&&MI.alert(c.msg)}}),f.sending=1)};MI.TalkList.prototype.confirm=function(b,a){var b=String(b),c=this,e=l(b),f=d(e,".msgBox")[0],g;c.creatConfirm();a&&(2==a?g=c.unfavTip:4==a?g=c.shieldTip:6==a?g=c.unShieldTip:10==a&&(g=c.noticeTip));g=a?g:c.removeTip;var h=d(e,".replyBox")[0],i=d(e,".relayNum")[0];MI.user.fun.apolloStyle?UI.prepend(c._confirm,f):UI.append(c._confirm,f);c.relayListHide(b);setTimeout(function(){d(c._confirm,"input")[0].focus()},0);c._confirm.tid=e.id;c._confirm.type=a;!a&&(!h&&i)&&(g=_("这条广播已经被{0}人转播点评过，确认删除吗？",i.innerHTML));c._confirmTip.innerHTML=g;c.talkBox&&(c.talkBox.display&&c.cur==e.id)&&(UI.remove(c.talkBox._body),UI.removeClass(e,"cur"),c.talkBox.display=0)};MI.tmpl.urlPreview='<div class="urlPreview"><div class="SA" style="display:none;"><em>◆</em><span>◆</span></div><a class="close" href="javascript:void(0)"></a><div class="urlIntro"><a class="ulink" target="_blank" href="#"></a></div><div class="urlCnt"></div></div>';var C=MI.TalkList.prototype,r=function(b){var b=b||window.event,a=UI.E(b),c=0,e=1;if(b.detail){if(c=0<b.detail?1:-1,-3>b.wheelDelta||3<b.wheelDelta)e=2}else if(c=0>b.wheelDelta?1:-1,-120>b.wheelDelta||120<b.wheelDelta)e=2;var b=w.scrollHeight,f=w.offsetHeight,d=w.scrollTop;return b<=f?!0:1<e?(a.prevent(),!1):1===c&&80>b-d-f?(d!=b-f&&(w.scrollTop=b-f),a.prevent(),!1):-1===c&&80>d?(a.prevent(),w.scrollTop=0,!1):!0},p=function(){UI.hide(u)},k=function(){clearTimeout(U);U=setTimeout(p,250)},n=function(b,a){if(J[a].info&&J[a].info.html&&!(!J[a].info.url?0:/[\/.](qzone\.qq|pengyou|weibo|t\.qq)\.com/.test(J[a].info.url))){var c=UI.html('<a title="'+_("查看预览")+'"class="tIcon ico_page" href="javascript:void(0)"></a>')[0];UI.after(c,b);c.onmouseover=function(){var b=this;ha=setTimeout(function(){var c=UI.parents(b,"msgBox"),c=UI.parent(c[c.length-1]),g=[UI.getX(c)+UI.width(c)+20,UI.getY(b)];u||(u=UI.html(j.tmpl)[0],s=d(u,".ulink,.urlIntro p")[0],w=d(u,".urlCnt")[0],N=d(u,".close")[0],O=d(u,".SA")[0],W=UI.DC("div"),j.navH=j.navH||(d(document.body,".tSearchNew")[0]?UI.height(l("header")||l("headWrap")):0),j._body=u,j._cnt=w,j._title=s,j._close=N,j._arrow=O,j.build(),N.onclick=function(){p();MI.Bos("btnUrlPreviewClose")},UI.EA(u,"mouseover",function(){clearTimeout(U)}),UI.EA(u,"mouseout",k),UI.EA(s,"click",function(a){UI.E(a).stop()}),UI.B.ie6&&UI.EA(window,"scroll",function(){u.style.top=UI.scrollY()+5+j.navH+"px"}),UI.hasClass(document.body,"ipad")||(w.onmousewheel=r,UI.B.firefox&&w.addEventListener("DOMMouseScroll",r,!1)),window.imgLoad=window.imgLoad||function(a){if(!UI.B.ie6)return false;var b=UI.width(w);if(a.width>b)a.width=b},window.imgError=window.imgError||function(){});if(a!=ia){var h=J[a].info,i=h.html,m="";ia=a;s.href=a;i=i.replace(/<\/?(html|head|base|meta)[^>]*?>/gi,"");m+='<div class="urlDescribeBox">';try{if(h.url&&(1==h.safe||3==h.safe||4==h.safe)){var x={};x[1]=_('安全等级：<span class="t">该网站安全风险暂时未知</span>');x[3]=_('安全等级：<span class="t">暂无安全风险</span>');x[4]=_('安全等级：<span class="t">暂无安全风险</span>');var n="",B="";1==h.safe&&(n="unsafe",B='<a target="_blank" class="report" href="http://guanjia.qq.com/trojan_false.html">'+_("举报")+"</a>");var q="";h.site&&h.site.url?q=MI.string.html(decodeURIComponent(h.site.url)):(q=MI.string.html(decodeURIComponent(h.url)),q=q.match(/(http:\/\/|https:\/\/)?(www.)?[\w-]+\.(com|net|org|gov|cc|biz|info|cn|it|so)(\.(cn|hk))*/),q=0<q.length?q[0]:"");var o="";if(1==h.safe||3==h.safe||4==h.safe)o=' <a target="blank" class="c_tx3" href="http://www.scanv.com/seccenter/search/'+q.replace(/(http:\/\/|https:\/\/)/gi,"")+'">查看详情</a>';m+='<span class="safeBox clear"><em class="ico safe_'+h.safe+'"></em><span class="safeLevel '+n+'"><strong>'+_("来源网站 ")+q+'</strong><br /><a href="'+MI.string.html(decodeURIComponent(h.url))+'" target="_blank">'+MI.string.html(decodeURIComponent(h.url))+'</a><span class="level clear"><span class="left">'+x[h.safe]+o+'</span><span class="right">'+B+'<a class="gb_btn gb_btn1" href="'+MI.string.html(decodeURIComponent(h.url))+'" target="_blank"><span class="t">'+_("访问该链接")+"</span></a></span></span></span></span>"}}catch(t){}if(1==h.safe||3==h.safe||4==h.safe)m+='<div class="urlDescribe">\t            <p class="noDuty">安全诊断结果由<img class="scanv" src="http://mat1.gtimg.com/www/mb/images/s/scanv.png" title="" alt="">网址安全中心为您提供。<br>温馨提示：网页内容变化快，请谨慎判断安全风险。</p>       </div>';m+="</div>";i.hasString("<body>")?/<body>\s*<\/body>/i.test(i)||(m+='<div class="urlContent">'+i+"</div>"):(i=i.replace(/<title>[^<>]*?<\/title>/gi,""),i=i.replace(/<\!--[^<>]*?--\>/g,""),W.innerHTML=i,UI.trim(UI.text(W))&&(m+='<div class="urlContent">'+i+"</div>"));w.innerHTML=m||_("抱歉，页面没有返回数据，暂时无法预览。");s.innerHTML=h.title||h.url;UI.each(UI.GT(w,"a"),function(a){if(!a)return false;UI.EA(a,"click",function(){MI.Bos("btnUrlPreviewContLink")})})}j.setPos(g);UI.EA(c,"mouseout",k);UI.EA(c,"mouseover",function(){clearTimeout(U)});UI.show(u);MI.Bos("btnUrlPreview")},200)};c.onmouseout=function(){clearTimeout(ha)}}},B=function(b,a,c){c=UI.html('<a title="'+_("查看预览")+'"class="tIcon ico_page" href="'+c+'"></a>')[0];UI.after(c,b);UI.A(b,"boss","btn_urlClick_hasPreview");c.onclick=function(){return!1};MI.sidePanelUrlProfile&&MI.sidePanelUrlProfile(d(a,"a.ico_page"))},j={navH:0,MIN_H:400,MIN_W:360,MAX_W:550},u,s,w,N,O,U,ha,W,ia,J={};j._body=u;j.data={};j.tmpl=MI.tmpl.urlPreview;j.build=function(){UI.append(j._body,document.body)};j.setPos=function(b){var a,c=b[0],e=b[1];a=UI.windowHeight()-10-j.navH;e=UI.windowWidth()-(UI.B.ie&&!UI.B.ie9?-5:13)-5;a=a>=j.MIN_H?a:j.MIN_H;e-b[0]>j.MAX_W?b=j.MAX_W:e-b[0]<j.MIN_W?(b=j.MIN_W,c=e-b):b=e-b[0];e=UI.scrollY()+5+j.navH;UI.B.ie6?u.style.cssText="left:"+(c-5)+"px;top:"+e+"px;width:"+b+"px;height:"+a+"px;":(u.style.cssText="left:"+(c-5)+"px;top:"+(j.navH+5)+"px;width:"+b+"px;height:"+a+"px;position:fixed",w.style.cssText="width:"+(b-20)+"px;height:"+(a-20-36)+"px;")};j.showPreview=function(b){var a=b.href;if(a)if(J[a])n(b,a);else{var c={url:a};if(j.data)for(var e in j.data)c[e]=j.data[e];MI.ajax({type:"get",url:MI.url.urlPreview,data:c,success:function(c){c=MI.json(c);J[a]=c;0==c.result&&n(b,a)}})}};j.addPreviewIconWide=function(b,a){var c=UI.A(b,"href");if(c)if(MI.Wide&&MI.Wide.urlPreviewCache&&MI.Wide.urlPreviewCache[""+c])B(b,a,c);else{var e={url:"http://api.t.qq.com/asyn/shortUrlPreview.php",type:"get",data:{url:c,r:MI.random()},success:function(e){var d=e,e=MI.json(e);0==e.result&&e.info&&(B(b,a,c),MI.Wide&&(MI.Wide.urlPreviewCache&&!MI.Wide.urlPreviewCache[""+c])&&(MI.Wide.urlPreviewCache[""+c]={data:d,getTime:+new Date}))}};MI.ajax(e)}};j.close=p;C.urlPreview=j;var T=function(b){F=UI.A(b,"pos").split(",");if(!(2>F.length||!UI.isNumber(1*F[0])||!UI.isNumber(1*F[1]))){UI.show(G);if(!K){G||(MI.tmpl.geolocation='<div style="top:0;left:0" class="comTips1 cardT"><a class="close" href="#"></a><div class="detailAddress" style="background:#fff;width:340px;margin:1px auto;"><p style="padding:3px 5px;color:#666;line-height:18px;border-bottom:1px solid #999;"></p></div><div class="areaWrap" id="areaWrap"></div><div class="SA"><em>◆</em><span>◆</span><b>◆</b></div></div>',G=UI.html(MI.tmpl.geolocation)[0],ja=d(G,".areaWrap")[0],X=d(G,".close")[0],Y=d(G,".detailAddress p")[0],X.onclick=function(){Z();return!1},X=null,UI.EA(document,"click",Z),UI.EA(G,"click",MI.cancelBubble));A=soso.maps;UI.append(G,document.body);ka=new A.Geocoder;K=new A.Map(ja,{animation:!0,center:new A.LatLng(F[1],F[0]),keyBoard:!0,scrollWheel:!0,zoomInByDblClick:!0,zoomLevel:15});new A.NavigationControl({align:A.ALIGN.TOP_LEFT,margin:new A.Size(5,15),style:A.NavigationControlStyle.SMALL,map:K});var a=new A.MarkerImage("http://mat1.gtimg.com/www/mb/images/map/fujinlogo.png",new A.Size(24,24),new A.Point(15,15),new A.Point(32,34));la=new A.Marker({map:K,position:new A.LatLng(F[1],F[0]),icon:a,animation:A.Animation.JUMP})}a=new A.LatLng(F[1],F[0]);ka.geocode({location:a},function(a,b){var c=K.getZoomLevel();b==A.GeolocationStatus.OK?(K.moveTo(new A.LatLng(1*F[1],1*F[0])),la.setPosition(new A.LatLng(1*F[1],1*F[0]))):4<c&&K.setZoomLevel(4)});var a=UI.A(b,"address")+"&nbsp;"||"&nbsp;",c='<a target="_blank" onmousedown="MI.Bos(\'btn_check_tweetNear\');" href="http://t.qq.com/map/lbs.php?'+("lat="+F[1]+"&lng="+F[0]+"&addr="+a)+'">',e=c+"["+_("查看附近的广播")+"]</a>";Y.innerHTML=c+a+"</a>"+e;G.style.left=UI.getX(b)-150+"px";G.style.top=UI.getY(b)+25+"px";b=UI.getY(b)+25+220+UI.height(Y)-UI.windowHeight()-UI.scrollY();0<b&&UI.scrollTo(document.body,UI.scrollX(),UI.scrollY()+b+5);T.delay=1;setTimeout(function(){T.delay=0},100)}},Z=function(){0==T.delay&&UI.hide(G)},K=null,la=null,A=null,G,ja,X,Y,F=[39.90923,116.397428],ma=!1,ka;MI.TalkList.prototype.geolocation={show:function(b){ma?T(b):UI.getScript("http://api.map.soso.com/v1.01/main.js",function(){T(b);ma=!0},"utf-8",1);return!1},hide:Z};var V=function(){na=setTimeout(function(){UI.hide(H)},100)},H,$,z=[],na,L={},P=0,I,aa;MI.TalkList.prototype.download={show:function(b,a){$=b.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(!H){MI.tmpl.download=['<div class="bigFileInfo dlLink"><b class="trib"><i class="tris"></i></b><span>',_("下载方式："),'</span><a href="#">',_("直接下载"),'</a> <a href="#">',_("旋风下载"),'</a><div class="loading" style="display:none;position:absolute;left:5%;top:5%;width:90%;height:90%;background-color:#fff;"></div></div>'].join("");H=UI.html(MI.tmpl.download)[0];z[0]=UI.GT(H,"a")[0];z[1]=UI.GT(H,"a")[1];loading=UI.GT(H,"div")[0];UI.append(H,document.body);H.onmouseout=V;H.onmouseover=function(){clearTimeout(na)};var c=function(){return MI.TalkBox&&MI.TalkBox.prototype&&MI.TalkBox.prototype.data&&2==MI.TalkBox.prototype.data.cflag||$&&2==UI.A($,"data-zone")};MI.app({TalkBoxRich:function(){UI.EA(z[0],"click",function(a){var a=UI.E(a),b=UI.A(z[0],"dllink");V();!c()&&MI.relay(I.id,aa,"好东西要分享，转播让你的朋友们也看看吧！");window.open(b);MI.Bos("btnFileDownloadDefault"+P);setTimeout(function(){MI.Bos("btnFileDownload",escape(I.path))},1E3);a.prevent()});UI.EA(z[1],"click",function(a){var b=UI.E(a);!c()&&MI.relay(I.id,aa,"好东西要分享，转播让你的朋友们也看看吧！");MI.App.qqDownload(z[1],a,21506);MI.Bos("btnFileDownloadXF"+P);setTimeout(function(){MI.Bos("btnQQDownload",escape(I.path))},1E3);b.prevent()})}})}var e=b.parentNode,f=d(e,".fileName")[0],g=UI.A(e,"rel");try{g=decodeURI(g)}catch(h){g=UI.text(f)}I={path:e.id,qid:UI.A(e,"qid")||0,name:g,ftype:UI.A(e,"ftype")||"1",id:UI.A(a,"id")};aa="我刚刚下载了文件【"+I.name+"】，推荐给你看看。"+UI.A(b,"href");P=0==I.qid?"0":"1";e=UI.getX(b)-10;f=UI.getY(b)+20;H.style.cssText="left:"+e+"px;top:"+f+"px;margin-left:0;";UI.show(H);var i=I;L[i.id]?(UI.A(z[0],"href",L[i.id][2]),UI.A(z[0],"dllink",L[i.id][0]),UI.A(z[0],"QHref",""),UI.A(z[1],"href",L[i.id][2]),UI.A(z[1],"QHref",L[i.id][1])):(UI.show(loading),3==i.ftype||25==i.ftype?MI.ajax({url:MI.url.applyDownloadXF,type:"get",data:{filehash:i.path,filename:i.name,R:+new Date},success:function(a){UI.hide(loading);a=MI.json(a);if(0==a.ret&&a.data){var a=a.data,b="http://t.qq.com/p/t/"+i.id+(0==i.qid?"":"/1");UI.cookie("FTN5K",a.com_cookie,1,"qq.com");UI.A(z[0],"href",b);UI.A(z[0],"dllink",a.com_url);UI.A(z[0],"QHref","");UI.A(z[1],"href",b);UI.A(z[1],"QHref",a.xf_url);L[i.id]=[a.com_url,a.xf_url,b]}else MI.alert(_("获取文件信息失败")),MI.Bos("btnFileDownloadFialXF"+P),V()}}):MI.ajax({url:MI.url.applyDownload,type:"post",data:{fileKey:i.path,appid:0!=i.qid?1:0,qid:i.qid,ftype:i.ftype},success:function(a){UI.hide(loading);a=MI.json(a);if(0==a.result&&a.info){if(a.info.keys){var b=a.info.keys[0],c="http://"+b.attach.dns+"/ftn_handler/"+b.strKey+"/"+encodeURIComponent(i.name);UI.cookie("FTN5K",b.attach.cookies,1,"qq.com");MI.app({QQDownload:function(){var a="qqdl://"+MI.qqdl.base64encode(c),b="http://t.qq.com/p/t/"+i.id+(0==i.qid?"":"/1");UI.A(z[0],"href",b);UI.A(z[0],"dllink",c);UI.A(z[0],"QHref","");UI.A(z[1],"href",b);UI.A(z[1],"QHref",a);L[i.id]=[c,a,b]}})}}else i.qid&&-8==a.result?MI.confirm({type:"error",title:_("只有群成员才能下载该文件"),content:_(""),confirmTxt:_("申请加入"),confirm:function(){window.open("http://qun.t.qq.com/"+a.qid);MI.dialog.hide()},cancelTxt:_("取消"),cancel:function(){}}):(MI.alert(_("获取文件信息失败")),MI.Bos("btnFileDownloadFial"+P)),V()}}));MI.Bos("btnShowDownload"+P)}};var pa=function(b){for(var a="",c=0;c<b.length;c++)a+='<p><span class="cNote">'+_("译")+"：</span>"+b[c].content,a+='<br /><span class="cNote">',a+=b[c].from||"",a+="</span></p>";oa.innerHTML=a},qa=function(){var b=UI.getY(D)+UI.height(D)-UI.windowHeight()-UI.scrollY();0<b&&UI.scrollTo(document.body,UI.scrollX(),UI.scrollY()+b+5)},Q=function(){clearTimeout(Q.delay);Q.delay=setTimeout(function(){UI.hide(D);M.style.lineHeight=1;UI.hide(M);ba=!1},100)},D,oa,ca,M,da=null,ea={},R="",ra=null,ba=!1,sa=300,ta=0;MI.TalkList.prototype.trans={show:function(b){if(!ba){var a=UI.parents(b,"msgBox")[0];if(a){ra=a.parentNode;R=UI.A(b,"tid")||d(a,".time")[0].href.replace(3===MI.hostType?/.*#id=/:/.*\//,"").split("?")[0];ta||(D||(MI.tmpl.trans=['<div class="comTips1"><div class="transWrap"><div class="transBox"></div><div class="transNote"><span class="left">',_("小贴士：越早参与翻译越容易被推荐！"),'</span><span class="right"><a class="transMe" href="#">',_("我来翻译"),'</a></span></div></div><div class="loading" style="position:absolute;width:100%;height:100%;top:0;left:0;background-color:#fff;background-position:22% 50%;"><span style="padding-left:90px;">',_("翻译机器人正在为你翻译..."),"</span></div></div>"].join(""),D=UI.html(MI.tmpl.trans)[0],oa=d(D,".transBox")[0],ca=d(D,".transMe")[0],M=d(D,".loading")[0],ca.onclick=function(){da||(da=new MI.TransMe("trans"));da.show({cont:"",title:_("我来更准确的翻译:"),talkId:R,offsetY:sa,type:1});MI.Bos("btnTransByMe");return!1},ca=null,D.onmouseout=Q,D.onmouseover=function(){clearTimeout(Q.delay);UI.show(D)},UI.clear(function(){D=null})),UI.append(D,document.body),ta=1);var a=UI.getX(b)-140,b=UI.getY(b)+25,c=UI.getX(ra);a<c&&(a=c);a+300>c+560&&(a=c+560-300);D.style.left=a+"px";D.style.top=b+"px";sa=b;UI.show(D);ba=!0;ea[R]?(pa(ea[R]),qa()):(a=UI.height(D),M.style.lineHeight=a-1+"px",UI.show(M),MI.ajax({url:MI.url.translate,data:{id:R},success:function(a){M.style.lineHeight=1;UI.hide(M);a=MI.json(a);if(a.result==0){pa(a.info.result);ea[R]=a.info.result;qa()}else{MI.alert(a.msg);Q()}}}));MI.Bos("btnShowTrans")}}},hide:Q};MI.TalkList.vote=function(b){var a=b.parentNode.parentNode,c=d(a,".vBox")[0],e=UI.A(a,"realurl");UI.A(a,"shorturl");UI.addClass(a,"vPlay bgr2");a='<div style="height:200px"></div><iframe width="100%" style="height:200px;display:none" onload="UI.show(this);try{var height=(this.contentWindow.document.body.scrollHeight||this.contentWindow.document.documentElement.scrollHeight)+5+\'px\';this.style.height=height;}catch(e){};UI.hide(this.previousSibling);UI.removeClass(this.parentNode,\'loading\');" src="'+e+'" frameborder="0" scrolling="no" allowtransparency="true"></iframe>';c?(UI.addClass(c,"loading"),c.innerHTML=a):UI.after(UI.html('<div class="vBox loading">'+a+"</div>")[0],b)};MI.TalkList.newVote=function(b){var a=b.parentNode.parentNode,c=d(a,".o_guess_pn")[0],e=UI.A(a,"realurl");UI.A(a,"shorturl");UI.addClass(a,"vPlay bgr2");var a=UI.parseUrl(e),f=UI.random(1,1E4),e='<div style="height:200px"></div><iframe width="460px" id="voteiframe_'+a.id+f+"\" style=\"height:200px;display:none\" onload=\"UI.show(this);try{UI.hide(this.previousSibling);UI.removeClass(this.parentNode,'loading');this.style.height=(this.contentWindow.document.body.scrollHeight || this.contentWindow.document.documentElement.scrollHeight)+5+'px';this.style.width=(this.contentWindow.document.body.scrollWidth || this.contentWindow.document.documentElement.scrollWidth)+'px';}catch(e){}\" src=\""+e+"&rand="+f+'" frameborder="0" scrolling="no" allowtransparency="true"></iframe>';c?(UI.addClass(c,"loading"),UI.show(c),c.innerHTML=e):UI.after(UI.html('<div class="o_guess_pn loading">'+e+"</div>")[0],b)};MI.TalkList.resizeVoteIframe=function(b,a){var c=l("voteiframe_"+b);if(!c)return!1;c.style.height=a+5+"px"};MI.TalkList.voteClose=function(b){UI.removeClass(b.parentNode.parentNode,"vPlay bgr2")};MI.TalkList.newVoteClose=function(b){b=b.parentNode.parentNode;UI.removeClass(b,"vPlay bgr2");UI.hide(d(b,".o_guess_pn")[0])};MI.TalkList.prototype.voteEvent=function(b){for(var a=0,c=b.length;a<c;a++){var e=b[a],f=d(e,".vtThumbs")[0];d(e,".vTools");e=d(e,".vClose")[0];f.onclick=function(){MI.TalkList.newVote(this);MI.Bos("btnVoteView");return!1};e.onclick=function(){MI.TalkList.newVoteClose(this);MI.Bos("btnVoteClose");return!1}}};MI.TalkList.fileEvent=function(b,a){for(var c=0,e=b.length;c<e;c++){var f=b[c],g=d(f,".download")[0],f=d(f,".ml10")[0];g&&(g.onclick=function(){MI.TalkList.prototype.download.show(this,a);return!1});f&&(f.onclick=function(){MI.TalkList.prototype.transferToMC(this,a);return false})}};MI.TalkList.prototype.transferToMC=function(b){MI.Bos("timelineMCBtn",0,0,1166);var a=b.parentNode,c=b.parentNode.parentNode.parentNode,e=c.parentNode,c=d(c,"div.userName")[0],f="";c&&(f=UI.A(c,"rel")||"");var c=d(e,".zfNum")[0]||d(e,".relay")[0]||d(e,".left .time")[0],g=(c=UI.A(c,"href"))&&"#"!=c&&0>c.indexOf("#")&&c.match(/[^\/]+$/g)[0]||UI.A(e,"id"),h=d(e,".left .f")[0],h=UI.A(h,"href"),i=c&&"#"!=c&&h.match(/[^\/]+$/g)&&h.match(/[^\/]+$/g)[0]||0;if(25==UI.A(a,"ftype"))return MI.alert("对不起，此文件无法转存<p class='cNote fs12'>微云转存暂不支持来自旋风离线分享的文件</p>"),!1;file={path:a.id,qid:UI.A(a,"qid")||0,name:name,ftype:UI.A(a,"ftype")||"1",id:g};MI.ajax({url:MI.url.applyDownload,type:"post",data:{fileKey:file.path,appid:0!=file.qid?1:0,qid:file.qid,ftype:file.ftype},success:function(c){c=MI.json(c);0==c.result&&c.info?UI.getScript("http://mat1.gtimg.com/www/mb/js/group/AntiCSRFToken_v1.0.js",function(){MI.ajax({url:"http://file.t.qq.com/air/transferToMicroCloud.php",type:"post",data:{fkey:a.id,ftype:UI.A(a,"ftype")||"0",qid:UI.A(a,"qid")||UI.A(e,"wqid")||i,token:QZFL.security.getAntiCSRFToken(),u:UI.A(a,"name")||f||""},success:function(c){c=MI.json(c);if(0==c.ret)return MI.Bos("timelineMCSucBtn",0,0,1166),MI.tip("转存成功",function(){var c=d(a,".fileName")[0],e=UI.A(a,"rel");try{e=decodeURI(e)}catch(f){e=UI.text(c)}var h,c=UI.A(b,"url")||UI.A(b,"href");h=UI.A(a,"ftype")?"#微云#我刚刚转存了文件【"+e+"】到微云[weiyun.com]，方便快捷，推荐给你看看。"+c:"#微云#我刚刚转存了文件【"+e+"】到微云[weiyun.com]，方便快捷，推荐给你看看。";setTimeout(function(){var a=b.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;!(MI.TalkBox&&MI.TalkBox.prototype&&MI.TalkBox.prototype.data&&2==MI.TalkBox.prototype.data.cflag||a&&2==UI.A(a,"data-zone"))&&MI.relay(g,h,"好东西要分享，转播让你的朋友们也看看吧！")},0)}),!0;-8==c.ret?(MI.alert("此文件太大，请使用旋风下载到本地查看<p class='cNote fs12'>文件大小超过1G，无法转存</p>"),MI.Bos("tl_over1G",0,0,1166)):1016==c.ret?(MI.Bos("tl_noMCUserBtn",0,0,1166),MI.confirm({type:"success",title:"欢迎使用微云",content:"微云会替您把文件永久保存到云端。<br>方便您在手机、电脑、web等多个终端中随时随地查看使用。",confirmTxt:"使用微云",confirm:function(){MI.Bos("tl_userMCBtn",0,0,1166);window.open("http://www.weiyun.com/disk/index.html?appid=30201")},cancelTxt:"取消",cancel:function(){}})):1053==c.ret?(MI.Bos("tl_isFull",0,0,1166),MI.alert("空间不足，暂不能转存此文件")):1051==c.ret?MI.alert("文件已转存，请前往<a href='http://www.weiyun.com/disk/index.html?appid=30201' target='_blank'>微云</a>查看"):1090==c.ret||1093==c.ret||1094==c.ret?(MI.Bos("tl_MCfail",0,0,1166),MI.alert("该文件无法转存，请下载查看")):(MI.Bos("tl_MCfail",0,0,1166),MI.alert("转存失败，请稍候再试或下载查看"));return!1}})}):file.qid&&-8==c.result?MI.confirm({type:"error",title:_("只有群成员才能转存该文件"),content:_(""),confirmTxt:_("申请加入"),confirm:function(){window.open("http://qun.t.qq.com/"+c.qid);MI.dialog.hide()},cancelTxt:_("取消"),cancel:function(){}}):MI.alert(_("获取文件信息失败"))}})};MI.TalkList.prototype.simMusicEvent=function(b){MI.TalkList.simMusic=1;for(var a=0,c=b.length;a<c;a++){var e=b[a];mThumbsBox=d(e,".mThumbsBox")[0];songUrl=UI.A(e,"songurl");simPause=d(e.parentNode,".simPause")[0];mThumbsBox.onclick=function(){MI.app({Music:function(){MI.TalkList.music(e);var a=d(e,".mBoxNew")[0];a.style.height=a.style.width="1px";UI.show(simPause);UI.hide(mThumbsBox);UI.hide(d(e,".vTools")[0]);var b=0,c;c=setInterval(function(){50>b?(b++,l("musicFlash0")&&(UI.hide(d(e,".vTools")[0]),UI.A(l("musicFlash0"),"width",1),UI.A(l("musicFlash0"),"height",1),clearInterval(c))):clearInterval(c)},10)}});return!1};simPause.onclick=function(){MI.TalkList.musicStop();UI.hide(this);UI.show(mThumbsBox);return!1}}};MI.TalkList.prototype.musicEvent=function(b){for(var a=this,c=0,e=b.length;c<e;c++){var f=b[c],g=d(f,".albumInfo .mThumbsBox")[0];if(g){var h=d(f,".albumPic a")[0],i=d(f,".albumPic img")[0],j=d(f,".albumInfo .songTit a")[0];g.onclick=h.onclick=j.onclick=function(){MI.app({Music:function(){MI.TalkList.music(f)}});return!1};i&&(i.onerror=function(){this.src="http://mat1.gtimg.com/www/mb/images/music_none.png";this.onerror=null})}else{g=d(f,".mThumbsBox")[0];j=d(f,".mBox")[0];d(j,".mTitBox");var h=d(j,".btn_mClose")[0],i=d(j,".btn_mPlay")[0],j=d(j,".btn_mPause_hover")[0],k=d(f.parentNode.parentNode,".msgCnt .ico_music")[0]||d(f.parentNode.parentNode,".msgCnt .ico_qlz")[0];g.onclick=i.onclick=function(){MI.app({Music:function(){MI.TalkList.music(f)}});return!1};k&&(k.onclick=function(){if(!MI.user.fun.newMusic){if(f&&f.isOpen)try{a.musicClose()}catch(b){}else a.music(f);return!1}});j.onclick=function(){MI.TalkList.musicStop();return false};h.onclick=function(){MI.TalkList.musicClose()};g=d(f.parentNode.parentNode,".msgCnt .ico_qlz");UI.each(g,function(a){a.title=_("绿钻贵族分享的高品质音乐，欢迎收听")})}}};MI.mediaMutex=function(b,a){var c=UI.parents(b,"mediaWrap")[0];if(c)for(var e=["picBox","videoBox","tl_imgGroup"],f=0,g=e.length;f<g;f++){var h=d(c,"."+e[f])[0];if(a)MI.TalkList.showEvent(h);else if(UI.parents(b,e[f])[0])MI.TalkList.showEvent(h);else if(UI.hide(d(c,"."+e[f])[0]),"picBox"==e[f]&&(h=d(c,"."+e[f])[0]))UI.hasClass(h,"big")&&UI.removeClass(h,"big"),(h=d(h,"canvas")[0])&&UI.hide(h)}};MI.TalkList.videoUrlVoid=function(b){var b=b.match(/http:\/\/([^\/]+)\//i),a="";if(!b[1])return a;for(var c="qq.com tudou.com youku.com 56.com tudou.com ku6.com yinyuetai.com sohu.com joy.cn 6.cn".split(" "),e=0,f=c.length;e<f;e++)if(RegExp(c[e]).test(b[1])){a=c[e].split(".")[0];break}return a};MI.TalkList.videoVid=function(b){var a="",b=b.split("?")[1].match(/(^|&)vid=([^&]*)(&|$)/);b[2]&&(a=b[2]);return a};MI.TalkList.video=function(b,a){try{MI.TalkList.musicClose()}catch(c){}try{MI.TalkList.videoClose()}catch(e){}var f;1==a?f=d(b.parentNode.parentNode,".videoBox")[0]:2==a&&(f=b.parentNode.parentNode);f.isOpen=!0;MI.TalkList.lastVideo=f;f=f.getAttribute("playurl");var g;"qq"==MI.TalkList.videoUrlVoid(f)&&UI.B.ipad?(f="http://vv.video.qq.com/geturl?vid="+MI.TalkList.videoVid(f)+"&callvar=QZOutputJson&otype=json&r="+MI.random(),UI.getScript(f,function(){(g=QZOutputJson.vd.vi[0].url)&&MI.TalkList.videoOpen(b,a,g,"mp4")})):MI.TalkList.videoOpen(b,a,f,"flash");UI.linkEvent("MI.TalkList.video");return!1};var fa;MI.TalkList.videoOpen=function(b,a,c,e){var f;f="mp4"==e?MI.tmpl.videoHTML5:UI.B.ie?MI.tmpl.videoObject:MI.tmpl.videoEmbed;var g,h,i;1==a?g=d(b.parentNode.parentNode,".videoBox")[0]:2==a&&(g=b.parentNode.parentNode);g.className.hasString("prizeCont")&&(fa||(fa=f.replace(/height="\d+"/,'height="345"')),f=fa);var j=d(g,".vWrap")[0];h=d(g,".vBox")[0];var k=d(g,".vThumbsBox")[0],n=UI.html('<div class="vBox" style="display:block"></div>')[0],l=unescape(g.getAttribute("minipicurl")),p=c?c:unescape(g.getAttribute("playurl")),o=unescape(g.getAttribute("realurl")),t=g.getAttribute("title")?g.getAttribute("title"):g.getAttribute("reltitle");MI.string.cut(t,40);var t=unescape(g.getAttribute("shorturl")),s=g.getAttribute("playurl"),r=MI.TalkList.videoUrlVoid(c),c="VideoPlay"+MI.random(),w="qq"==r?"&amp;outhost="+encodeURIComponent(location.href):"";switch(r){case "tudou":s.split("/");break;case "ku6":s.split("/");break;case "joy":s.split("/")[4].slice(0,7);break;case "sohu":s.split("/");break;case "yinyuetai":s.split("/")}if(1==a){a=d(g,".vTools")[0];i=f.replace(/\$VideoPlayID/g,c).replace(/\$VideoPlayUrl/g,p).replace(/\$MiniPic/g,l).replace(/\$outhost/g,w);k&&UI.hide(k);UI.show(a);if(g.play){e=d(b.parentNode.parentNode,".videoBox")[0];e=d(e,".vClose")[0];try{MI.TalkList.videoClose(e,1)}catch(B){}g.play=0;return!1}h||UI.append(n,j)}else if(2==a){b=d(g,".vTools")[0];i=f.replace(/\$VideoPlayID/g,c).replace(/\$VideoPlayUrl/g,p).replace(/\$outhost/g,w);if(g.play)return g.play=0,!1;UI.hide(k);b.style.display="block";h||UI.append(n,j)}g.play=1;UI.addClass(g,"vPlay bgr2");UI.B.ipad||UI.addClass(d(g,".vBox")[0],"loading");if(UI.B.ipad&&"flash"==e||MI.noFlash()&&"mp4"!=e)i='<div style="font-size:14px;padding:20px 0;background:#F9F9F9;margin:5px;">'+_("对不起，由于您的浏览器未安装Flash播放器，不支持播放。<br>建议您尝试来源网页：")+'<a href="http://url.cn/'+t+'" target="_blank">http://url.cn/'+t+"</a></div>";n.innerHTML=i;MI.mediaMutex(j);MI.Bos("btnVideoView",escape(o));return!1};MI.noFlash=function(){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){for(var b=navigator.plugins["Shockwave Flash"].description.split(" "),a=0;a<b.length;++a)if(!isNaN(parseInt(b[a])))var c=b[a];var e=6<=c}else if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e=!0}catch(f){e=!1}MI.noFlash=function(){return!e};return e?!1:!0};MI.TalkList.videoClose=function(){var b=MI.TalkList.lastVideo,a=d(b,".vWrap")[0],c=d(b,".vBox")[0],e=d(b,".vThumbsBox")[0],f=d(b,".vTools")[0],g=d(e,".vThumbs")[0],g=d(g,"img")[0];b.play=0;UI.removeClass(b,"vPlay bgr2");UI.removeClass(c,"loading");e.style.display="inline";MI.TalkList.resizePic(g);f.style.display="none";UI.remove(c);MI.mediaMutex(a,1);MI.TalkList.lastVideo.isOpen=!1;UI.linkEvent("MI.TalkList.videoClose");return!1};MI.TalkList.prototype._pageMode=function(b){function a(){c.pageModeData&&c.pageModeData.page&&(c.pageModeCur=c.pageModeData.page);c.xhr.pageMode&&c.xhr.pageMode.abort();c.xhr.pageMode=MI.ajax({url:UI.A(c._more,"rel"),data:c.pageModeData||"",type:"get",success:function(a){a=MI.json(a);c.pageModeData?c.addMore(a):c.pageModeShow(a)}})}var c=this,b=b||{};c.pageModeCur=1;c._page=UI.html('<div id="pageNav" class="blueFoot"></div>')[0];UI.after(c._page,b.target||c._body.parentNode);c.auto=0;c._more&&setTimeout(function(){UI.remove(c._more.parentNode)},0);c._page.onclick=function(e){e=UI.E(e).target;if("A"==e.nodeName)return c.pageModeData=MI.json(UI.A(e,"rel")),a(),b.call&&b.call(c.pageModeCur),!1};c.pageModeLoaded||(c.pageModeData="",a(),c.pageModeLoaded=1)};MI.TalkList.prototype.pageModeShow=function(b){if(this.pageModeCur&&b.info&&b.info.page){var a=this,c=b.info.page.pages,e=b.info.page.prev,f=b.info.page.next,d=[],h,i=1;a.pageModeCur=b.info.page.page;if(c){var j=function(a){a.id||delete a.id;a.time||delete a.time;return UI.json2str(a)};1!=a.pageModeCur&&e&&d.push('<a href="#" rel=\''+j(e)+'\' class="pageBtn"><< '+_("上一页")+"</a>");UI.each(c,function(b){var c="";1==b.page&&(h=1);if(1<=b.page-i){if(1<b.page-i||!h)d.push('<a href="#" rel=\''+c+"'>1</a>"),h=1;1<b.page-i&&d.push("<span>...</span>")}c=j(b);a.pageModeCur==b.page?d.push("<strong>"+b.page+"</strong>"):d.push('<a href="#" rel=\''+c+"'>"+b.page+"</a>");i=b.page});f&&(f.page!=i&&d.push("<span>...</span>"),d.push('<a href="#" rel=\''+j(f)+'\' class="pageBtn">'+_("下一页")+" >></a>"))}a._page.innerHTML=d.join("");a.pageModeData&&(a.clear(),window.scrollTo(0,0),MI.Crs.iconPic="x");UI.hide(a._new);UI.removeClass(a._new,"loading")}};MI.TalkList.prototype.miniModel=function(b){var b=b||{},a=this,c=a.eventCall,e=/(\(\d*\))/gi,f=function(a,c){a&&(a.onclick=null,a.href=c,a.target="_blank",b.bosName&&(a.onmousedown=function(){MI.Bos(b.bosName)}))};a.eventCall=function(g){c&&UI.isFunction(c)&&c.call(a,g);var h="http://t.qq.com/p/t/"+MI.string.parseInt(g.id),i=d(g,".areaInfo,.btn_trans,.pubDate");UI.each(i,function(a){UI.hide(a)});b.useRichMedia||(i=d(g,"canvas"),UI.each(i,function(a){UI.hide(a)}));b.showRelayComtNum||(i=d(g,".relay,.comt,.reply"),UI.each(i,function(a){var b=a.innerHTML,b=b.replace(e,"");a.innerHTML=b}));i=d(g,".mod_tl_recom .userPic");UI.each(i,function(a){a.style.display="block"});var i=d(g,".left .zfNum"),j=UI.hasClass(g,"wqprivate");b.useQunUrl&&j&&UI.each(i,function(a){UI.hide(a);UI.hide(a.parentNode.parentNode)});UI.each(d(g,".left"),function(a){a.clientHeight==0&&UI.hide(a.parentNode)});setTimeout(function(){var a=d(g,".detail_link a");UI.each(a,function(a){f(a,h)});if(!b.useRichMedia){a=d(g,"a.ico_video,.vThumbsBox,.musicBox .mThumbsBox,.vtThumbs,.albumPic a,.songTit a,.mThumbsBox");UI.each(a,function(a){f(a,h)});a=d(g,".pic");UI.each(a,function(a){var c=UI.A(a,"href");f(a,h);b.checkPicInFullScreen?a.onclick=function(a){var b=g.id.match(/([0-9]{5,})($|\D)/);UI.E(a).stop();MI.cPlayer.load2Show(b&&b[1],0,[c]);return false}:a.href=a.href+"?funBox=none"});if(a=d(g,".vtThumbs img")[0])a.onclick=null}if(a=d(g,".view")[0])a.target="_blank";if(b.userOpenWin){a=d(g,".userName a,.msgCnt strong a,.msgCnt a");UI.each(a,function(a){a.target="_blank";if(b.bosName)a.onmousedown=function(){MI.Bos(b.bosName)}})}},10);if(b.useModel){var k=MI.string.parseInt(g.id),i=d(g,".funBox a.relay"),n=a.relayBox&&a.relayBox.data?a.relayBox.data.pgv_ref:"",s=function(a,b,c){MI.ajax({url:MI.url.relayList,data:{id:a,attr:1},type:"get",async:false,success:function(a){a=MI.json(a);MI.Bos("getAuthCheck_wideR_float",0,0,214);var e={},f=0;if(a.result==0){e["0"]=a.attr&&a.attr.fCom?1:0;e["1"]=a.attr&&a.attr.fRt?1:0;e[b]&&(f=1)}if(f){a=_("由于用户设置，你无法{0}此微博",b?_("转播"):_("评论"));MI.Bos("showTips_wideR_float",0,0,214);MI.alert(a);return false}c&&c()},fail:function(){c&&c()}})};UI.each(i,function(b){UI.A(b,"clickE",1);b.onclick=function(){s(k,1,function(){var b="";d(g,".replyBox")[0]&&(b=a.getRelayOld(g,".msgCnt"));MI.relay(k,b,"",n);return false})}});i=d(g,".funBox a.comt");UI.each(i,function(b){UI.A(b,"clickE",1);b.onclick=function(){s(k,0,function(){var b="";d(g,".replyBox")[0]&&(b=a.getRelayOld(g,".msgCnt"));MI.comment(k,b,"",n);return false})}});var i=d(g,".funBox a.reply"),j=d(g,".userName strong a")[0],l="";j&&(l=j.innerHTML);UI.each(i,function(a){UI.A(a,"clickE",1);a.onclick=function(){MI.reply(k,l,"",n);return false}})}};a.eventsCall=function(){setTimeout(function(){MI.Crs(1,a._body)},200)};b.useRichMedia||(a.musicEvent=function(){},a.voteEvent=function(){});return a.eventCall}})();MI.TalkList.prototype.showReadList=function(l,d){var C=this,r="read_del_"+MI.user.account;MI.ajax({url:MI.url.readList,type:"get",data:{_r:MI.random(),id:l},success:function(p){var k,n,B,j;if((p=MI.json(p))&&0===p.result){k=p.info.user;UI.each((MI.S(r)||"").split("#"),function(d){d&&(d=d.split("@"))&&d[0]===String(l)&&(B=d[1])});p.info.owner!==MI.user.account&&p.info.show&&(!B||6E5<+new Date-B)?k.unshift({miniUrl:MI.user.pic.replace(/\/[0-9]+$/,""),nick:MI.user.name,id:MI.user.account}):1===k.length&&k[0].id===MI.user.account&&(k=[]);n=[];k.length?(UI.each(k,function(d,j){var k,s,l=d.id===MI.user.account;0<j&&l||9<n.length||(l?(s=_("删除我的阅读记录"),k="javascript:;"):(s=d.nick.toTitle()+"(@"+d.id+")",k=MI.getInternalUrl(0,d.id),k+=(-1<k.indexOf("?")||-1<k.indexOf("#")?"&":"?")+"&from=readnum"),d.avatar=d.miniUrl&&0>d.miniUrl.indexOf("head_normal_")&&0>d.miniUrl.indexOf("images/head")?d.miniUrl+"/20":"http://mat1.gtimg.com/www/mb/img/p1/head_normal_20.png",n.push(['<span class="recent_link"><a href="',k,'" title="',s,'" class="need-card" boss="btnReadUser"><img height="20" width="20" src="',d.avatar,'"></a>',l?'<a class="read_close" boss="btnReadDel" title="'+_("删除我的阅读记录")+'" href="Javascript:;">x</a>':"","</span>"].join("")))}),j=n.join("")+_(" 最近读过")):j=_("暂无阅读记录");k=C._readList;k||(k=C._readList=UI.html('<div class="pubInfo recent_read"></div>')[0]);k.innerHTML=j;var u=$$(k,"a")[0];u&&setTimeout(function(){MI.focus(u)},0);j=k;var s,w,N;s=UI.GC(j,".read_close")[0];MI.Card.build(j,".need-card",5);s&&(w=s.parentNode,w.onclick=function(){MI.ajax({url:MI.url.delReadList,type:"get",data:{_r:MI.random(),id:l},success:function(d){var j=false;if((d=MI.json(d))&&d.result===0){MI.tip(_("删除成功"));UI.GC(w.parentNode,".recent_link").length===1?w.parentNode.innerHTML=_("暂无阅读记录"):UI.remove(w);if(delReadList=MI.S(r)||""){delReadList=delReadList.split("#");UI.each(delReadList,function(d,k){d=d.split("@");if(d[0]===l){delReadList[k]=+new Date;j=true}})}else delReadList=[];if(!j){for(;delReadList.length>19;)delReadList.shift();delReadList.push(l+"@"+ +new Date)}MI.S(r,delReadList.join("#"))}}})},UI.B.ie6&&(w.onmouseover=function(){clearTimeout(N);s.className="read_close hover"},w.onmouseout=function(){N=setTimeout(function(){s.className="read_close"},100)}));d&&d(k,p.info.total||n.length);C.curReadList=l;UI.show(k)}}})};MI.TalkList.prototype._collapseTarget=null;MI.TalkList.prototype._collapseType=0;MI.TalkList.prototype.collapseInit=function(){this._collapseTarget=null;this._collapseType=0};MI.TalkList.prototype.collapse=function(l,d){var C=this._collapseType;1==C||2==C||3==C?this.replyHide():4==C?this.relayListHide():5==C?UI.hide(this._readList):6==C&&UI.hide(this._likeList);if(this._collapseTarget==l)return this.collapseInit(),!1;this._collapseTarget=l;this._collapseType=d;return!0};MI.TalkList.prototype.like=function(){var l=function(d,l,p){MI.ajax({url:MI.url.like,type:"post",data:{_r:MI.random(),pid:d,like:l?0:1},success:function(d){(d=MI.json(d))&&0!==d.result&&-10!==d.result&&MI.alert(d.msg);p&&p(d)}})},d=function(d,r){UI.A(r,"loading")||(UI.A(r,"loading",1),l(d,!0,function(d){var k=r.parentNode,n=UI.next(k),l,j,u;UI.A(r,"loading","");if(n&&d&&(d.result===0||d.result===-10)){l=UI.GC(k,".like_plus")[0];UI.show(n);l.style.marginTop="-10px";l.style.display="block";j=UI.GT(n,"span")[0]||{};if(d.result===0){if(u=UI.hasClass(k.parentNode,"left")){k.style.position="relative";if(!UI.B.ie||document.documentMode>7)l.style.left="0px"}UI.animate(l,"marginTop",-35,function(){var d,n;UI.hide(l);j.innerHTML=parseInt(j.innerHTML,10)+1;if(!u)if(d=UI.GC(k.parentNode.parentNode.parentNode,".replyBox")[0])if(d=UI.GC(d,".ico_likeb")[0]){UI.removeClass(d,"ico_likeb");UI.addClass(d,"ico_likea");d.parentNode.title=_("取消赞");d=UI.next(d.parentNode);UI.removeClass(d,"num_likeb");UI.addClass(d,"int_havelike");n=UI.GT(d,"span")[0];n.innerHTML=parseInt(n.innerHTML,10)+1;UI.show(d)}},0.2)}else if(d.result===-10){UI.hide(l);if(j.innerHTML==="0")j.innerHTML="1";MI.tip(_("您已经赞过这条微博了"))}UI.removeClass(r,"ico_likeb");UI.removeClass(n,"num_likeb");UI.addClass(n,"int_havelike");UI.addClass(r,"ico_likea");k.title=_("取消赞")}}))};d.unlike=function(d,r){var p=this;UI.A(r,"loading")||(UI.A(r,"loading",1),l(d,!1,function(d){var n=r.parentNode,l=UI.next(n),j;UI.A(r,"loading","");if(l&&d&&d.result===0){j=UI.GT(l,"span")[0]||{};d=parseInt(j.innerHTML,10)-1;if(isNaN(d)||d<1)d=0;j.innerHTML=d;j.innerHTML==="0"&&UI.hide(l);UI.removeClass(r,"ico_likea");UI.removeClass(l,"int_havelike");UI.addClass(r,"ico_likeb");UI.addClass(l,"num_likeb");n.title=_("赞");p._collapseTarget===l&&p._collapseType===6&&p.collapse(l,6)}}))};d.showList=function(d,l){var p=this;MI.ajax({url:MI.url.readList,type:"get",data:{_r:MI.random(),type:1,id:d},success:function(k){var n,B=[],j;if((k=MI.json(k))&&0===k.result){n=k.info.user;n.length?(UI.each(n,function(d){var j,k;9<B.length||(d.nick=d.nick||"",k=d.nick.toTitle()+"(@"+d.id+")",j=MI.getInternalUrl(0,d.id),j+=(-1<j.indexOf("?")||-1<j.indexOf("#")?"&":"?")+"&from=likenum",d.avatar=d.miniUrl&&0>d.miniUrl.indexOf("head_normal_")&&0>d.miniUrl.indexOf("images/head")?d.miniUrl+"/20":"http://mat1.gtimg.com/www/mb/img/p1/head_normal_20.png",B.push(['<span class="recent_link"><a href="',j,'" title="',k,'" class="need-card" boss=""><img height="20" width="20" src="',d.avatar,'"></a></span>'].join("")))}),j=parseInt(k.info.total,10),j=isNaN(j)?"":j,n=B.join("")+'<a href="'+MI.getInternalUrl(1,d,"/?filter=8")+'" target="_blank">'+_((10<j?" 等":" ")+j+"人觉得很赞")+"</a>"):n=_("暂无赞记录");k=p._likeList;k||(k=p._likeList=UI.html('<div class="pubInfo recent_read"></div>')[0]);k.innerHTML=n;var u=$$(k,"a")[0];u&&setTimeout(function(){MI.focus(u)},0);MI.Card.build(k,".need-card",5);l&&l(k,j||B.length);UI.show(k)}}})};d.doLikeRequest=l;return d}();MI.TalkList._showPicPreview=function(){var l=null,d=null,C,r,p;_winWidth=function(){var d=window.innerWidth,l=document.compatMode;if(l||UI.B.ie)d="CSS1Compat"===l?document.documentElement.clientWidth:document.body.clientWidth;return d};_loadListAndShow=function(d,l){MI.cPlayer.load2Show(d,0,[l]);r.hide()};r=function(k){var n,B,j,u,s,w=function(){l=setTimeout(function(){UI.hide(n);d=null},100)};u=UI.A(k,"data-rpurl");clearTimeout(l);n=UI.G("mi-tl-picpreview");n||(n=document.body.appendChild(UI.html('<div id="mi-tl-picpreview" class="pop_img_drop"></div>')[0]),n.onmouseover=function(){clearTimeout(l)},n.onmouseout=w);n.onclick=function(){r.click(k)};d!==k&&(n.innerHTML='<img src="'+u+'/160">',B=UI.getX(k),j=UI.getY(k)+16,k.onmouseout=w,k.onclick=function(){r.click(this)},s="display:block;top:"+j+"px;left:"+B+"px;z-index:1000",n.style.cssText=s,p=new Image,p.onload=function(){if(C===u){var d=_winWidth(),j=p.width+8;if(B+j>d)n.style.cssText=s+";left:"+(d-j)+"px"}},p.src=u+"/160",d=k,C=u)};r.click=function(d){for(var l=d;l&&!l.id;)l=l.parentNode;l&&(l.id&&l.id.match(/([0-9]{5,})($|\D)/))&&(_loadListAndShow(RegExp.$1,UI.A(d,"data-rpurl")),MI.Bos("btnClickRtPics"));this.hide()};r.hide=function(){UI.hide(UI.G("mi-tl-picpreview"))};return r}();/*version:98172*//*  |xGv00|dfe9ec365e38948ad33e35d3e13191b1 */